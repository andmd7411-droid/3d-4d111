"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[65],{2877:function(e,t,r){var s,n,i,a;let o;r.d(t,{C:function(){return u}}),(i=s||(s={})).LOAD="LOAD",i.EXEC="EXEC",i.FFPROBE="FFPROBE",i.WRITE_FILE="WRITE_FILE",i.READ_FILE="READ_FILE",i.DELETE_FILE="DELETE_FILE",i.RENAME="RENAME",i.CREATE_DIR="CREATE_DIR",i.LIST_DIR="LIST_DIR",i.DELETE_DIR="DELETE_DIR",i.ERROR="ERROR",i.DOWNLOAD="DOWNLOAD",i.PROGRESS="PROGRESS",i.LOG="LOG",i.MOUNT="MOUNT",i.UNMOUNT="UNMOUNT";let l=(o=0,()=>o++);Error("unknown message type");let h=Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),c=Error("called FFmpeg.terminate()");Error("failed to import ffmpeg-core.js");class u{#e=null;#t={};#r={};#s=[];#n=[];loaded=!1;#i=()=>{this.#e&&(this.#e.onmessage=({data:{id:e,type:t,data:r}})=>{switch(t){case s.LOAD:this.loaded=!0,this.#t[e](r);break;case s.MOUNT:case s.UNMOUNT:case s.EXEC:case s.FFPROBE:case s.WRITE_FILE:case s.READ_FILE:case s.DELETE_FILE:case s.RENAME:case s.CREATE_DIR:case s.LIST_DIR:case s.DELETE_DIR:this.#t[e](r);break;case s.LOG:this.#s.forEach(e=>e(r));break;case s.PROGRESS:this.#n.forEach(e=>e(r));break;case s.ERROR:this.#r[e](r)}delete this.#t[e],delete this.#r[e]})};#a=({type:e,data:t},r=[],s)=>this.#e?new Promise((n,i)=>{let a=l();this.#e&&this.#e.postMessage({id:a,type:e,data:t},r),this.#t[a]=n,this.#r[a]=i,s?.addEventListener("abort",()=>{i(new DOMException(`Message # ${a} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(h);on(e,t){"log"===e?this.#s.push(t):"progress"===e&&this.#n.push(t)}off(e,t){"log"===e?this.#s=this.#s.filter(e=>e!==t):"progress"===e&&(this.#n=this.#n.filter(e=>e!==t))}load=({classWorkerURL:e,...t}={},{signal:n}={})=>(this.#e||(this.#e=e?new Worker(new URL(e,"file:///C:/Users/andre/OneDrive/Bureau/site%20web%203d%204d%20dfx/node_modules/@ffmpeg/ffmpeg/dist/esm/classes.js"),{type:"module"}):new Worker(r.tu(new URL(r.p+r.u(244),r.b)),{type:void 0}),this.#i()),this.#a({type:s.LOAD,data:t},void 0,n));exec=(e,t=-1,{signal:r}={})=>this.#a({type:s.EXEC,data:{args:e,timeout:t}},void 0,r);ffprobe=(e,t=-1,{signal:r}={})=>this.#a({type:s.FFPROBE,data:{args:e,timeout:t}},void 0,r);terminate=()=>{for(let e of Object.keys(this.#r))this.#r[e](c),delete this.#r[e],delete this.#t[e];this.#e&&(this.#e.terminate(),this.#e=null,this.loaded=!1)};writeFile=(e,t,{signal:r}={})=>{let n=[];return t instanceof Uint8Array&&n.push(t.buffer),this.#a({type:s.WRITE_FILE,data:{path:e,data:t}},n,r)};mount=(e,t,r)=>this.#a({type:s.MOUNT,data:{fsType:e,options:t,mountPoint:r}},[]);unmount=e=>this.#a({type:s.UNMOUNT,data:{mountPoint:e}},[]);readFile=(e,t="binary",{signal:r}={})=>this.#a({type:s.READ_FILE,data:{path:e,encoding:t}},void 0,r);deleteFile=(e,{signal:t}={})=>this.#a({type:s.DELETE_FILE,data:{path:e}},void 0,t);rename=(e,t,{signal:r}={})=>this.#a({type:s.RENAME,data:{oldPath:e,newPath:t}},void 0,r);createDir=(e,{signal:t}={})=>this.#a({type:s.CREATE_DIR,data:{path:e}},void 0,t);listDir=(e,{signal:t}={})=>this.#a({type:s.LIST_DIR,data:{path:e}},void 0,t);deleteDir=(e,{signal:t}={})=>this.#a({type:s.DELETE_DIR,data:{path:e}},void 0,t)}(a=n||(n={})).MEMFS="MEMFS",a.NODEFS="NODEFS",a.NODERAWFS="NODERAWFS",a.IDBFS="IDBFS",a.WORKERFS="WORKERFS",a.PROXYFS="PROXYFS"},723:function(e,t,r){function s(e,t="utf8"){return new TextDecoder(t).decode(e)}r.d(t,{Jx:function(){return N}});let n=new TextEncoder,i=(()=>{let e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])})(),a={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class o{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(e=8192,t={}){let r=!1;"number"==typeof e?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);let s=t.offset?t.offset>>>0:0,n=e.byteLength-s,i=s;(ArrayBuffer.isView(e)||e instanceof o)&&(e.byteLength!==e.buffer.byteLength&&(i=e.byteOffset+s),e=e.buffer),r?this.lastWrittenByte=n:this.lastWrittenByte=0,this.buffer=e,this.length=n,this.byteLength=n,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,n),this._mark=0,this._marks=[]}available(e=1){return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(e=1){return this.offset+=e,this}back(e=1){return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){let e=this._marks.pop();if(void 0===e)throw Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(e=1){if(!this.available(e)){let t=2*(this.offset+e),r=new Uint8Array(t);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=t,this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(e=1){return this.readArray(e,"uint8")}readArray(e,t){let r=a[t].BYTES_PER_ELEMENT*e,s=this.byteOffset+this.offset,n=this.buffer.slice(s,s+r);if(this.littleEndian===i&&"uint8"!==t&&"int8"!==t){let e=new Uint8Array(this.buffer.slice(s,s+r));e.reverse();let n=new a[t](e.buffer);return this.offset+=r,n.reverse(),n}let o=new a[t](n);return this.offset+=r,o}readInt16(){let e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){let e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){let e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){let e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){let e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){let e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){let e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){let e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(e=1){let t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(e=1){return s(this.readBytes(e))}decodeText(e=1,t="utf8"){return s(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(n.encode(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}var l,h,c=r(3425);let u=[];for(let e=0;e<256;e++){let t=e;for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;u[e]=t}function p(e,t,r){let s=e.readUint32(),n=(4294967295^function(e,t,r){let s=4294967295;for(let e=0;e<r;e++)s=u[(s^t[e])&255]^s>>>8;return s}(0,new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t))>>>0;if(n!==s)throw Error(`CRC mismatch for chunk ${r}. Expected ${s}, found ${n}`)}function f(e,t,r){for(let s=0;s<r;s++)t[s]=e[s]}function d(e,t,r,s){let n=0;for(;n<s;n++)t[n]=e[n];for(;n<r;n++)t[n]=e[n]+t[n-s]&255}function g(e,t,r,s){let n=0;if(0===r.length)for(;n<s;n++)t[n]=e[n];else for(;n<s;n++)t[n]=e[n]+r[n]&255}function m(e,t,r,s,n){let i=0;if(0===r.length){for(;i<n;i++)t[i]=e[i];for(;i<s;i++)t[i]=e[i]+(t[i-n]>>1)&255}else{for(;i<n;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<s;i++)t[i]=e[i]+(t[i-n]+r[i]>>1)&255}}function x(e,t,r,s,n){let i=0;if(0===r.length){for(;i<n;i++)t[i]=e[i];for(;i<s;i++)t[i]=e[i]+t[i-n]&255}else{for(;i<n;i++)t[i]=e[i]+r[i]&255;for(;i<s;i++)t[i]=e[i]+function(e,t,r){let s=e+t-r,n=Math.abs(s-e),i=Math.abs(s-t),a=Math.abs(s-r);return n<=i&&n<=a?e:i<=a?t:r}(t[i-n],r[i],r[i-n])&255}}let b=255===new Uint8Array(new Uint16Array([255]).buffer)[0],y=255===new Uint8Array(new Uint16Array([255]).buffer)[0],w=new Uint8Array(0);function A(e){let t,r;let{data:s,width:n,height:i,channels:a,depth:o}=e,l=Math.ceil(o/8)*a,h=Math.ceil(o/8*a*n),c=new Uint8Array(i*h),u=w,p=0;for(let e=0;e<i;e++){switch(t=s.subarray(p+1,p+1+h),r=c.subarray(e*h,(e+1)*h),s[p]){case 0:f(t,r,h);break;case 1:d(t,r,h,l);break;case 2:g(t,r,u,h);break;case 3:m(t,r,u,h,l);break;case 4:x(t,r,u,h,l);break;default:throw Error(`Unsupported filter: ${s[p]}`)}u=r,p+=h+1}if(16!==o)return c;{let e=new Uint16Array(c.buffer);if(y)for(let t=0;t<e.length;t++){var b;e[t]=(255&(b=e[t]))<<8|b>>8&255}return e}}let T=Uint8Array.of(137,80,78,71,13,10,26,10);function k(e){if(!function(e){if(e.length<T.length)return!1;for(let t=0;t<T.length;t++)if(e[t]!==T[t])return!1;return!0}(e.readBytes(T.length)))throw Error("wrong PNG signature")}let E=new TextDecoder("latin1"),_=/^[\u0000-\u00FF]*$/;function R(e){for(e.mark();0!==e.readByte(););let t=e.offset;e.reset();let r=E.decode(e.readBytes(t-e.offset-1));return e.skip(1),!function(e){if(function(e){if(!_.test(e))throw Error("invalid latin1 text")}(e),0===e.length||e.length>79)throw Error("keyword length must be between 1 and 79")}(r),r}let v={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},M={UNKNOWN:-1,DEFLATE:0},S={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},I={NONE:0,BACKGROUND:1,PREVIOUS:2},L={SOURCE:0,OVER:1};class U extends o{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(e,t={}){super(e);let{checkCrc:r=!1}=t;this._checkCrc=r,this._inflator=new c.T_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=M.UNKNOWN,this._filterMethod=-1,this._interlaceMethod=S.UNKNOWN,this._colorType=v.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(k(this);!this._end;){let e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(k(this);!this._end;){let e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){let r=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case"tEXt":!function(e,t,r){var s;let n=R(t);e[n]=(s=r-n.length-1,E.decode(t.readBytes(s)))}(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e)}if(this.offset-r!==e)throw Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?p(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){let r=this.offset;switch("fdAT"!==t&&"IDAT"!==t&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=r+e}if(this.offset-r!==e)throw Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?p(this,e+4,t):this.skip(4)}decodeIHDR(){let e;let t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=function(e){if(1!==e&&2!==e&&4!==e&&8!==e&&16!==e)throw Error(`invalid bit depth: ${e}`);return e}(this.readUint8());let r=this.readUint8();switch(this._colorType=r,r){case v.GREYSCALE:e=1;break;case v.TRUECOLOUR:e=3;break;case v.INDEXED_COLOUR:e=1;break;case v.GREYSCALE_ALPHA:e=2;break;case v.TRUECOLOUR_ALPHA:e=4;break;case v.UNKNOWN:default:throw Error(`Unknown color type: ${r}`)}if(this._png.channels=e,this._compressionMethod=this.readUint8(),this._compressionMethod!==M.DEFLATE)throw Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){let e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!=0)throw RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);let t=e/3;this._hasPalette=!0;let r=[];this._palette=r;for(let e=0;e<t;e++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;let t=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,t,e)),this._inflator.err)throw Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,r=this.offset+this.byteOffset;if(r+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case v.GREYSCALE:case v.TRUECOLOUR:if(e%2!=0)throw RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break;case v.INDEXED_COLOUR:{if(e>this._palette.length)throw Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let t=0;for(;t<e;t++){let e=this.readByte();this._palette[t].push(e)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case v.UNKNOWN:case v.GREYSCALE_ALPHA:case v.TRUECOLOUR_ALPHA:default:throw Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){let t=R(this),r=this.readUint8();if(r!==M.DEFLATE)throw Error(`Unsupported iCCP compression method: ${r}`);let s=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:(0,c.rr)(s)}}decodepHYs(){let e=this.readUint32(),t=this.readUint32(),r=this.readByte();this._png.resolution={x:e,y:t,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){let t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:8===this._apng.depth?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(e);if(r){if(r.data=A({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),0===e||0===r.xOffset&&0===r.yOffset&&r.width===this._png.width&&r.height===this._png.height)t.data=r.data;else{let s=this._apng.frames.at(e-1);this.disposeFrame(r,s,t),this.addFrameDataToCanvas(t,r)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,r){switch(e.disposeOp){case I.NONE:break;case I.BACKGROUND:for(let t=0;t<this._png.height;t++)for(let s=0;s<this._png.width;s++){let n=(t*e.width+s)*this._png.channels;for(let e=0;e<this._png.channels;e++)r.data[n+e]=0}break;case I.PREVIOUS:r.data.set(t.data);break;default:throw Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){let r=1<<this._png.depth,s=(e,r)=>({index:((e+t.yOffset)*this._png.width+t.xOffset+r)*this._png.channels,frameIndex:(e*t.width+r)*this._png.channels});switch(t.blendOp){case L.SOURCE:for(let r=0;r<t.height;r++)for(let n=0;n<t.width;n++){let{index:i,frameIndex:a}=s(r,n);for(let r=0;r<this._png.channels;r++)e.data[i+r]=t.data[a+r]}break;case L.OVER:for(let n=0;n<t.height;n++)for(let i=0;i<t.width;i++){let{index:a,frameIndex:o}=s(n,i);for(let s=0;s<this._png.channels;s++){let n=t.data[o+this._png.channels-1]/r,i=Math.floor(n*(s%(this._png.channels-1)==0?1:t.data[o+s])+(1-n)*e.data[a+s]);e.data[a+s]+=i}}break;default:throw Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw Error(`Error while decompressing the data: ${this._inflator.err}`);let e=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(0!==this._filterMethod)throw Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===S.NO_INTERLACE)this._png.data=A({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===S.ADAM7)this._png.data=function(e){let{data:t,width:r,height:s,channels:n,depth:i}=e,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*n,l=new Uint8Array(s*r*o),h=0;for(let e=0;e<7;e++){let n=a[e],i=Math.ceil((r-n.x)/n.xStep),c=Math.ceil((s-n.y)/n.yStep);if(i<=0||c<=0)continue;let u=i*o,p=new Uint8Array(u);for(let e=0;e<c;e++){let a=t[h++],c=t.subarray(h,h+u);h+=u;let b=new Uint8Array(u);!function(e,t,r,s,n,i){switch(e){case 0:f(t,r,n);break;case 1:d(t,r,n,i);break;case 2:g(t,r,s,n);break;case 3:m(t,r,s,n,i);break;case 4:x(t,r,s,n,i);break;default:throw Error(`Unsupported filter: ${e}`)}}(a,c,b,p,u,o),p.set(b);for(let t=0;t<i;t++){let i=n.x+t*n.xStep,a=n.y+e*n.yStep;if(!(i>=r)&&!(a>=s))for(let e=0;e<o;e++)l[(a*r+i)*o+e]=b[t*o+e]}}}if(16!==i)return l;{let e=new Uint16Array(l.buffer);if(b)for(let t=0;t<e.length;t++){var c;e[t]=(255&(c=e[t]))<<8|c>>8&255}return e}}({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){let e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:I.NONE,blendOp:L.SOURCE,data:e}),this._inflator=new c.T_,this._writingDataChunks=!1}}function N(e,t){return new U(e,t).decode()}(l=h||(h={}))[l.UNKNOWN=0]="UNKNOWN",l[l.METRE=1]="METRE"},5218:function(e,t,r){r.d(t,{iZ:function(){return W}});var s={},n=Uint8Array,i=Uint16Array,a=Int32Array,o=new n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(e,t){for(var r=new i(31),s=0;s<31;++s)r[s]=t+=1<<e[s-1];for(var n=new a(r[30]),s=1;s<30;++s)for(var o=r[s];o<r[s+1];++o)n[o]=o-r[s]<<5|s;return{b:r,r:n}},u=c(o,2),p=u.b,f=u.r;p[28]=258,f[258]=28;for(var d=c(l,0),g=d.b,m=d.r,x=new i(32768),b=0;b<32768;++b){var y=(43690&b)>>1|(21845&b)<<1;y=(61680&(y=(52428&y)>>2|(13107&y)<<2))>>4|(3855&y)<<4,x[b]=((65280&y)>>8|(255&y)<<8)>>1}for(var w=function(e,t,r){for(var s,n=e.length,a=0,o=new i(t);a<n;++a)e[a]&&++o[e[a]-1];var l=new i(t);for(a=1;a<t;++a)l[a]=l[a-1]+o[a-1]<<1;if(r){s=new i(1<<t);var h=15-t;for(a=0;a<n;++a)if(e[a])for(var c=a<<4|e[a],u=t-e[a],p=l[e[a]-1]++<<u,f=p|(1<<u)-1;p<=f;++p)s[x[p]>>h]=c}else for(a=0,s=new i(n);a<n;++a)e[a]&&(s[a]=x[l[e[a]-1]++]>>15-e[a]);return s},A=new n(288),b=0;b<144;++b)A[b]=8;for(var b=144;b<256;++b)A[b]=9;for(var b=256;b<280;++b)A[b]=7;for(var b=280;b<288;++b)A[b]=8;for(var T=new n(32),b=0;b<32;++b)T[b]=5;var k=w(A,9,0),E=w(T,5,0),_=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},R=function(e,t,r){var s=t/8|0;return(e[s]|e[s+1]<<8)>>(7&t)&r},v=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},M=function(e){return(e+7)/8|0},S=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new n(e.subarray(t,r))},I=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],L=function(e,t,r){var s=Error(t||I[e]);if(s.code=e,Error.captureStackTrace&&Error.captureStackTrace(s,L),!r)throw s;return s},U=function(e,t,r){r<<=7&t;var s=t/8|0;e[s]|=r,e[s+1]|=r>>8},N=function(e,t,r){r<<=7&t;var s=t/8|0;e[s]|=r,e[s+1]|=r>>8,e[s+2]|=r>>16},O=function(e,t){for(var r=[],s=0;s<e.length;++s)e[s]&&r.push({s:s,f:e[s]});var a=r.length,o=r.slice();if(!a)return{t:H,l:0};if(1==a){var l=new n(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var h=r[0],c=r[1],u=0,p=1,f=2;for(r[0]={s:-1,f:h.f+c.f,l:h,r:c};p!=a-1;)h=r[r[u].f<r[f].f?u++:f++],c=r[u!=p&&r[u].f<r[f].f?u++:f++],r[p++]={s:-1,f:h.f+c.f,l:h,r:c};for(var d=o[0].s,s=1;s<a;++s)o[s].s>d&&(d=o[s].s);var g=new i(d+1),m=C(r[p-1],g,0);if(m>t){var s=0,x=0,b=m-t,y=1<<b;for(o.sort(function(e,t){return g[t.s]-g[e.s]||e.f-t.f});s<a;++s){var w=o[s].s;if(g[w]>t)x+=y-(1<<m-g[w]),g[w]=t;else break}for(x>>=b;x>0;){var A=o[s].s;g[A]<t?x-=1<<t-g[A]++-1:++s}for(;s>=0&&x;--s){var T=o[s].s;g[T]==t&&(--g[T],++x)}m=t}return{t:new n(g),l:m}},C=function(e,t,r){return -1==e.s?Math.max(C(e.l,t,r+1),C(e.r,t,r+1)):t[e.s]=r},F=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new i(++t),s=0,n=e[0],a=1,o=function(e){r[s++]=e},l=1;l<=t;++l)if(e[l]==n&&l!=t)++a;else{if(!n&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(n),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(n);a=1,n=e[l]}return{c:r.subarray(0,s),n:t}},P=function(e,t){for(var r=0,s=0;s<t.length;++s)r+=e[s]*t[s];return r},B=function(e,t,r){var s=r.length,n=M(t+2);e[n]=255&s,e[n+1]=s>>8,e[n+2]=255^e[n],e[n+3]=255^e[n+1];for(var i=0;i<s;++i)e[n+i+4]=r[i];return(n+4+s)*8},D=function(e,t,r,s,n,a,c,u,p,f,d){U(t,d++,r),++n[256];for(var g,m,x,b,y=O(n,15),_=y.t,R=y.l,v=O(a,15),M=v.t,S=v.l,I=F(_),L=I.c,C=I.n,D=F(M),z=D.c,H=D.n,j=new i(19),G=0;G<L.length;++G)++j[31&L[G]];for(var G=0;G<z.length;++G)++j[31&z[G]];for(var $=O(j,7),V=$.t,K=$.l,W=19;W>4&&!V[h[W-1]];--W);var X=f+5<<3,q=P(n,A)+P(a,T)+c,Y=P(n,_)+P(a,M)+c+14+3*W+P(j,V)+2*j[16]+3*j[17]+7*j[18];if(p>=0&&X<=q&&X<=Y)return B(t,d,e.subarray(p,p+f));if(U(t,d,1+(Y<q)),d+=2,Y<q){g=w(_,R,0),m=_,x=w(M,S,0),b=M;var Z=w(V,K,0);U(t,d,C-257),U(t,d+5,H-1),U(t,d+10,W-4),d+=14;for(var G=0;G<W;++G)U(t,d+3*G,V[h[G]]);d+=3*W;for(var Q=[L,z],J=0;J<2;++J)for(var ee=Q[J],G=0;G<ee.length;++G){var et=31&ee[G];U(t,d,Z[et]),d+=V[et],et>15&&(U(t,d,ee[G]>>5&127),d+=ee[G]>>12)}}else g=k,m=A,x=E,b=T;for(var G=0;G<u;++G){var er=s[G];if(er>255){var et=er>>18&31;N(t,d,g[et+257]),d+=m[et+257],et>7&&(U(t,d,er>>23&31),d+=o[et]);var es=31&er;N(t,d,x[es]),d+=b[es],es>3&&(N(t,d,er>>5&8191),d+=l[es])}else N(t,d,g[er]),d+=m[er]}return N(t,d,g[256]),d+m[256]},z=new a([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),H=new n(0),j=function(e,t,r,s,h,c){var u=c.z||e.length,p=new n(s+u+5*(1+Math.ceil(u/7e3))+h),d=p.subarray(s,p.length-h),g=c.l,x=7&(c.r||0);if(t){x&&(d[0]=c.r>>3);for(var b=z[t-1],y=b>>13,w=8191&b,A=(1<<r)-1,T=c.p||new i(32768),k=c.h||new i(A+1),E=Math.ceil(r/3),_=2*E,R=function(t){return(e[t]^e[t+1]<<E^e[t+2]<<_)&A},v=new a(25e3),I=new i(288),L=new i(32),U=0,N=0,O=c.i||0,C=0,F=c.w||0,P=0;O+2<u;++O){var H=R(O),j=32767&O,G=k[H];if(T[j]=G,k[H]=j,F<=O){var $=u-O;if((U>7e3||C>24576)&&($>423||!g)){x=D(e,d,0,v,I,L,N,C,P,O-P,x),C=U=N=0,P=O;for(var V=0;V<286;++V)I[V]=0;for(var V=0;V<30;++V)L[V]=0}var K=2,W=0,X=w,q=j-G&32767;if($>2&&H==R(O-q))for(var Y=Math.min(y,$)-1,Z=Math.min(32767,O),Q=Math.min(258,$);q<=Z&&--X&&j!=G;){if(e[O+K]==e[O+K-q]){for(var J=0;J<Q&&e[O+J]==e[O+J-q];++J);if(J>K){if(K=J,W=q,J>Y)break;for(var ee=Math.min(q,J-2),et=0,V=0;V<ee;++V){var er=O-q+V&32767,es=T[er],en=er-es&32767;en>et&&(et=en,G=er)}}}G=T[j=G],q+=j-G&32767}if(W){v[C++]=268435456|f[K]<<18|m[W];var ei=31&f[K],ea=31&m[W];N+=o[ei]+l[ea],++I[257+ei],++L[ea],F=O+K,++U}else v[C++]=e[O],++I[e[O]]}}for(O=Math.max(O,F);O<u;++O)v[C++]=e[O],++I[e[O]];x=D(e,d,g,v,I,L,N,C,P,O-P,x),g||(c.r=7&x|d[x/8|0]<<3,x-=7,c.h=k,c.p=T,c.i=O,c.w=F)}else{for(var O=c.w||0;O<u+g;O+=65535){var eo=O+65535;eo>=u&&(d[x/8|0]=g,eo=u),x=B(d,x+1,e.subarray(O,eo))}c.i=u}return S(p,0,s+M(x)+h)},G=function(){var e=1,t=0;return{p:function(r){for(var s=e,n=t,i=0|r.length,a=0;a!=i;){for(var o=Math.min(a+2655,i);a<o;++a)n+=s+=r[a];s=(65535&s)+15*(s>>16),n=(65535&n)+15*(n>>16)}e=s,t=n},d:function(){return e%=65521,t%=65521,(255&e)<<24|(65280&e)<<8|(255&t)<<8|t>>8}}},$=function(e,t,r,s,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),o=new n(a.length+e.length);o.set(a),o.set(e,a.length),e=o,i.w=a.length}return j(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,s,i)},V=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},K=function(e,t){var r=t.level;if(e[0]=120,e[1]=(0==r?0:r<6?1:9==r?3:2)<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=G();s.p(t.dictionary),V(e,2,s.d())}};function W(e,t){t||(t={});var r=G();r.p(e);var s=$(e,t,t.dictionary?6:2,4);return K(s,t),V(s,s.length-4,r.d()),s}var X="undefined"!=typeof TextDecoder&&new TextDecoder;try{X.decode(H,{stream:!0})}catch(e){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout},1176:function(e,t,r){function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=Array(t);r<t;r++)s[r]=e[r];return s}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var s,n,i,a,o=[],l=!0,h=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(s=i.call(r)).done)&&(o.push(s.value),o.length!==t);l=!0);}catch(e){h=!0,n=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(h)throw n}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(t,{Z:function(){return n}})},1154:function(e,t,r){r.d(t,{Z:function(){return s}});function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},3847:function(e,t,r){r.d(t,{dc:function(){return a},Wn:function(){return l}});let s=Error("failed to get response body reader"),n=Error("failed to complete download"),i=e=>new Promise((t,r)=>{let s=new FileReader;s.onload=()=>{let{result:e}=s;e instanceof ArrayBuffer?t(new Uint8Array(e)):t(new Uint8Array)},s.onerror=e=>{r(Error(`File could not be read! Code=${e?.target?.error?.code||-1}`))},s.readAsArrayBuffer(e)}),a=async e=>{let t;if("string"==typeof e)t=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0)):await (await fetch(e)).arrayBuffer();else if(e instanceof URL)t=await (await fetch(e)).arrayBuffer();else{if(!(e instanceof File||e instanceof Blob))return new Uint8Array;t=await i(e)}return new Uint8Array(t)},o=async(e,t)=>{let r;let i=await fetch(e);try{let a=parseInt(i.headers.get("Content-Length")||"-1"),o=i.body?.getReader();if(!o)throw s;let l=[],h=0;for(;;){let{done:r,value:s}=await o.read(),i=s?s.length:0;if(r){if(-1!=a&&a!==h)throw n;t&&t({url:e,total:a,received:h,delta:i,done:r});break}l.push(s),h+=i,t&&t({url:e,total:a,received:h,delta:i,done:r})}let c=new Uint8Array(h),u=0;for(let e of l)c.set(e,u),u+=e.length;r=c.buffer}catch(s){console.log("failed to send download progress event: ",s),r=await i.arrayBuffer(),t&&t({url:e,total:r.byteLength,received:r.byteLength,delta:0,done:!0})}return r},l=async(e,t,r=!1,s)=>{let n=new Blob([r?await o(e,s):await (await fetch(e)).arrayBuffer()],{type:t});return URL.createObjectURL(n)}},7970:function(e,t,r){function s(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}r.d(t,{TU:function(){return em}});var n=s(),i={exec:()=>null};function a(e,t=""){let r="string"==typeof e?e:e.source,s={replace:(e,t)=>{let n="string"==typeof t?t:t.source;return n=n.replace(l.caret,"$1"),r=r.replace(e,n),s},getRegex:()=>new RegExp(r,t)};return s}var o=(()=>{try{return RegExp("(?<=1)(?<!1)"),!0}catch{return!1}})(),l={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},h=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,c=/(?:[*+-]|\d{1,9}[.)])/,u=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,p=a(u).replace(/bull/g,c).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),f=a(u).replace(/bull/g,c).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),d=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,g=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,m=a(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",g).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),x=a(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,c).getRegex(),b="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",y=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,w=a("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",y).replace("tag",b).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),A=a(d).replace("hr",h).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",b).getRegex(),T={blockquote:a(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",A).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:m,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:h,html:w,lheading:p,list:x,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:A,table:i,text:/^[^\n]+/},k=a("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",h).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",b).getRegex(),E={...T,lheading:f,table:k,paragraph:a(d).replace("hr",h).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",k).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",b).getRegex()},_={...T,html:a(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",y).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:i,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:a(d).replace("hr",h).replace("heading",` *#{1,6} *[^
]`).replace("lheading",p).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},R=/^( {2,}|\\)\n(?!\s*$)/,v=/[\p{P}\p{S}]/u,M=/[\s\p{P}\p{S}]/u,S=/[^\s\p{P}\p{S}]/u,I=a(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,M).getRegex(),L=/(?!~)[\p{P}\p{S}]/u,U=a(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",o?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),N=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,O=a(N,"u").replace(/punct/g,v).getRegex(),C=a(N,"u").replace(/punct/g,L).getRegex(),F="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",P=a(F,"gu").replace(/notPunctSpace/g,S).replace(/punctSpace/g,M).replace(/punct/g,v).getRegex(),B=a(F,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,L).getRegex(),D=a("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,S).replace(/punctSpace/g,M).replace(/punct/g,v).getRegex(),z=a(/\\(punct)/,"gu").replace(/punct/g,v).getRegex(),H=a(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),j=a(y).replace("(?:-->|$)","-->").getRegex(),G=a("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",j).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),$=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,V=a(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",$).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),K=a(/^!?\[(label)\]\[(ref)\]/).replace("label",$).replace("ref",g).getRegex(),W=a(/^!?\[(ref)\](?:\[\])?/).replace("ref",g).getRegex(),X=a("reflink|nolink(?!\\()","g").replace("reflink",K).replace("nolink",W).getRegex(),q=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Y={_backpedal:i,anyPunctuation:z,autolink:H,blockSkip:U,br:R,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:i,emStrongLDelim:O,emStrongRDelimAst:P,emStrongRDelimUnd:D,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:V,nolink:W,punctuation:I,reflink:K,reflinkSearch:X,tag:G,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:i},Z={...Y,link:a(/^!?\[(label)\]\((.*?)\)/).replace("label",$).getRegex(),reflink:a(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",$).getRegex()},Q={...Y,emStrongRDelimAst:B,emStrongLDelim:C,url:a(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",q).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:a(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",q).getRegex()},J={...Q,br:a(R).replace("{2,}","*").getRegex(),text:a(Q.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ee={normal:T,gfm:E,pedantic:_},et={normal:Y,gfm:Q,breaks:J,pedantic:Z},er={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},es=e=>er[e];function en(e,t){if(t){if(l.escapeTest.test(e))return e.replace(l.escapeReplace,es)}else if(l.escapeTestNoEncode.test(e))return e.replace(l.escapeReplaceNoEncode,es);return e}function ei(e){try{e=encodeURI(e).replace(l.percentDecode,"%")}catch{return null}return e}function ea(e,t){let r=e.replace(l.findPipe,(e,t,r)=>{let s=!1,n=t;for(;--n>=0&&"\\"===r[n];)s=!s;return s?"|":" |"}).split(l.splitPipe),s=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),t){if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("")}for(;s<r.length;s++)r[s]=r[s].trim().replace(l.slashPipe,"|");return r}function eo(e,t,r){let s=e.length;if(0===s)return"";let n=0;for(;n<s;){let i=e.charAt(s-n-1);if(i!==t||r){if(i!==t&&r)n++;else break}else n++}return e.slice(0,s-n)}function el(e,t,r,s,n){let i=t.href,a=t.title||null,o=e[1].replace(n.other.outputLinkReplace,"$1");s.state.inLink=!0;let l={type:"!"===e[0].charAt(0)?"image":"link",raw:r,href:i,title:a,text:o,tokens:s.inlineTokens(o)};return s.state.inLink=!1,l}var eh=class{options;rules;lexer;constructor(e){this.options=e||n}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:eo(e,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let e=t[0],r=function(e,t,r){let s=e.match(r.other.indentCodeCompensation);if(null===s)return t;let n=s[1];return t.split(`
`).map(e=>{let t=e.match(r.other.beginningSpace);if(null===t)return e;let[s]=t;return s.length>=n.length?e.slice(n.length):e}).join(`
`)}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){let t=eo(e,"#");(this.options.pedantic||!t||this.rules.other.endingSpaceChar.test(t))&&(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:eo(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let e=eo(t[0],`
`).split(`
`),r="",s="",n=[];for(;e.length>0;){let t=!1,i=[],a;for(a=0;a<e.length;a++)if(this.rules.other.blockquoteStart.test(e[a]))i.push(e[a]),t=!0;else if(t)break;else i.push(e[a]);e=e.slice(a);let o=i.join(`
`),l=o.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${o}`:o,s=s?`${s}
${l}`:l;let h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(l,n,!0),this.lexer.state.top=h,0===e.length)break;let c=n.at(-1);if(c?.type==="code")break;if(c?.type==="blockquote"){let t=c.raw+`
`+e.join(`
`),i=this.blockquote(t);n[n.length-1]=i,r=r.substring(0,r.length-c.raw.length)+i.raw,s=s.substring(0,s.length-c.text.length)+i.text;break}if(c?.type==="list"){let t=c.raw+`
`+e.join(`
`),i=this.list(t);n[n.length-1]=i,r=r.substring(0,r.length-c.raw.length)+i.raw,s=s.substring(0,s.length-c.raw.length)+i.raw,e=t.substring(n.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:n,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let r=t[1].trim(),s=r.length>1,n={type:"list",raw:"",ordered:s,start:s?+r.slice(0,-1):"",loose:!1,items:[]};r=s?`\\d{1,9}\\${r.slice(-1)}`:`\\${r}`,this.options.pedantic&&(r=s?r:"[*+-]");let i=this.rules.other.listItemRegex(r),a=!1;for(;e;){let r=!1,s="",o="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;s=t[0],e=e.substring(s.length);let l=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,e=>" ".repeat(3*e.length)),h=e.split(`
`,1)[0],c=!l.trim(),u=0;if(this.options.pedantic?(u=2,o=l.trimStart()):c?u=t[1].length+1:(u=(u=t[2].search(this.rules.other.nonSpaceChar))>4?1:u,o=l.slice(u),u+=t[1].length),c&&this.rules.other.blankLine.test(h)&&(s+=h+`
`,e=e.substring(h.length+1),r=!0),!r){let t=this.rules.other.nextBulletRegex(u),r=this.rules.other.hrRegex(u),n=this.rules.other.fencesBeginRegex(u),i=this.rules.other.headingBeginRegex(u),a=this.rules.other.htmlBeginRegex(u);for(;e;){let p=e.split(`
`,1)[0],f;if(h=p,f=this.options.pedantic?h=h.replace(this.rules.other.listReplaceNesting,"  "):h.replace(this.rules.other.tabCharGlobal,"    "),n.test(h)||i.test(h)||a.test(h)||t.test(h)||r.test(h))break;if(f.search(this.rules.other.nonSpaceChar)>=u||!h.trim())o+=`
`+f.slice(u);else{if(c||l.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||n.test(l)||i.test(l)||r.test(l))break;o+=`
`+h}c||h.trim()||(c=!0),s+=p+`
`,e=e.substring(p.length+1),l=f.slice(u)}}n.loose||(a?n.loose=!0:this.rules.other.doubleBlankLine.test(s)&&(a=!0)),n.items.push({type:"list_item",raw:s,task:!!this.options.gfm&&this.rules.other.listIsTask.test(o),loose:!1,text:o,tokens:[]}),n.raw+=s}let o=n.items.at(-1);if(!o)return;for(let e of(o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd(),n.raw=n.raw.trimEnd(),n.items)){if(this.lexer.state.top=!1,e.tokens=this.lexer.blockTokens(e.text,[]),e.task){if(e.text=e.text.replace(this.rules.other.listReplaceTask,""),e.tokens[0]?.type==="text"||e.tokens[0]?.type==="paragraph"){e.tokens[0].raw=e.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),e.tokens[0].text=e.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let e=this.lexer.inlineQueue.length-1;e>=0;e--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[e].src)){this.lexer.inlineQueue[e].src=this.lexer.inlineQueue[e].src.replace(this.rules.other.listReplaceTask,"");break}}let t=this.rules.other.listTaskCheckbox.exec(e.raw);if(t){let r={type:"checkbox",raw:t[0]+" ",checked:"[ ]"!==t[0]};e.checked=r.checked,n.loose?e.tokens[0]&&["paragraph","text"].includes(e.tokens[0].type)&&"tokens"in e.tokens[0]&&e.tokens[0].tokens?(e.tokens[0].raw=r.raw+e.tokens[0].raw,e.tokens[0].text=r.raw+e.tokens[0].text,e.tokens[0].tokens.unshift(r)):e.tokens.unshift({type:"paragraph",raw:r.raw,text:r.raw,tokens:[r]}):e.tokens.unshift(r)}}if(!n.loose){let t=e.tokens.filter(e=>"space"===e.type),r=t.length>0&&t.some(e=>this.rules.other.anyLine.test(e.raw));n.loose=r}}if(n.loose)for(let e of n.items)for(let t of(e.loose=!0,e.tokens))"text"===t.type&&(t.type="paragraph");return n}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:r,title:s}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let r=ea(t[1]),s=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),n=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(r.length===s.length){for(let e of s)this.rules.other.tableAlignRight.test(e)?i.align.push("right"):this.rules.other.tableAlignCenter.test(e)?i.align.push("center"):this.rules.other.tableAlignLeft.test(e)?i.align.push("left"):i.align.push(null);for(let e=0;e<r.length;e++)i.header.push({text:r[e],tokens:this.lexer.inline(r[e]),header:!0,align:i.align[e]});for(let e of n)i.rows.push(ea(e,i.header.length).map((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:i.align[t]})));return i}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let e=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;let t=eo(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{let e=function(e,t){if(-1===e.indexOf(")"))return -1;let r=0;for(let t=0;t<e.length;t++)if("\\"===e[t])t++;else if("("===e[t])r++;else if(")"===e[t]&&--r<0)return t;return r>0?-2:-1}(t[2],"()");if(-2===e)return;if(e>-1){let r=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,r).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){let e=this.rules.other.pedanticHrefTitle.exec(r);e&&(r=e[1],s=e[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(r=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?r.slice(1):r.slice(1,-1)),el(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let r;if((r=this.rules.inline.reflink.exec(e))||(r=this.rules.inline.nolink.exec(e))){let e=t[(r[2]||r[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){let e=r[0].charAt(0);return{type:"text",raw:e,text:e}}return el(r,e,r[0],this.lexer,this.rules)}}emStrong(e,t,r=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!(!s||s[3]&&r.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!r||this.rules.inline.punctuation.exec(r))){let r=[...s[0]].length-1,n,i,a=r,o=0,l="*"===s[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+r);null!=(s=l.exec(t));){if(!(n=s[1]||s[2]||s[3]||s[4]||s[5]||s[6]))continue;if(i=[...n].length,s[3]||s[4]){a+=i;continue}if((s[5]||s[6])&&r%3&&!((r+i)%3)){o+=i;continue}if((a-=i)>0)continue;i=Math.min(i,i+a+o);let t=[...s[0]][0].length,l=e.slice(0,r+s.index+t+i);if(Math.min(r,i)%2){let e=l.slice(1,-1);return{type:"em",raw:l,text:e,tokens:this.lexer.inlineTokens(e)}}let h=l.slice(2,-2);return{type:"strong",raw:l,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(e),s=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return r&&s&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let e,r;return r="@"===t[2]?"mailto:"+(e=t[1]):e=t[1],{type:"link",raw:t[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,r;if("@"===t[2])r="mailto:"+(e=t[0]);else{let s;do s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(s!==t[0]);e=t[0],r="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}},ec=class e{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||n,this.options.tokenizer=this.options.tokenizer||new eh,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:l,block:ee.normal,inline:et.normal};this.options.pedantic?(t.block=ee.pedantic,t.inline=et.pedantic):this.options.gfm&&(t.block=ee.gfm,this.options.breaks?t.inline=et.breaks:t.inline=et.gfm),this.tokenizer.rules=t}static get rules(){return{block:ee,inline:et}}static lex(t,r){return new e(r).lex(t)}static lexInline(t,r){return new e(r).inlineTokens(t)}lex(e){e=e.replace(l.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){for(this.options.pedantic&&(e=e.replace(l.tabCharGlobal,"    ").replace(l.spaceLine,""));e;){let s;if(this.options.extensions?.block?.some(r=>!!(s=r.call({lexer:this},e,t))&&(e=e.substring(s.raw.length),t.push(s),!0)))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);let r=t.at(-1);1===s.raw.length&&void 0!==r?r.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);let r=t.at(-1);r?.type==="paragraph"||r?.type==="text"?(r.raw+=(r.raw.endsWith(`
`)?"":`
`)+s.raw,r.text+=`
`+s.text,this.inlineQueue.at(-1).src=r.text):t.push(s);continue}if((s=this.tokenizer.fences(e))||(s=this.tokenizer.heading(e))||(s=this.tokenizer.hr(e))||(s=this.tokenizer.blockquote(e))||(s=this.tokenizer.list(e))||(s=this.tokenizer.html(e))){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);let r=t.at(-1);r?.type==="paragraph"||r?.type==="text"?(r.raw+=(r.raw.endsWith(`
`)?"":`
`)+s.raw,r.text+=`
`+s.raw,this.inlineQueue.at(-1).src=r.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},t.push(s));continue}if((s=this.tokenizer.table(e))||(s=this.tokenizer.lheading(e))){e=e.substring(s.raw.length),t.push(s);continue}let n=e;if(this.options.extensions?.startBlock){let t=1/0,r=e.slice(1),s;this.options.extensions.startBlock.forEach(e=>{"number"==typeof(s=e.call({lexer:this},r))&&s>=0&&(t=Math.min(t,s))}),t<1/0&&t>=0&&(n=e.substring(0,t+1))}if(this.state.top&&(s=this.tokenizer.paragraph(n))){let i=t.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):t.push(s),r=n.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);let r=t.at(-1);r?.type==="text"?(r.raw+=(r.raw.endsWith(`
`)?"":`
`)+s.raw,r.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=r.text):t.push(s);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r,s=e,n=null;if(this.tokens.links){let e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(n=this.tokenizer.rules.inline.reflinkSearch.exec(s));)e.includes(n[0].slice(n[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,n.index)+"["+"a".repeat(n[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(n=this.tokenizer.rules.inline.anyPunctuation.exec(s));)s=s.slice(0,n.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;null!=(n=this.tokenizer.rules.inline.blockSkip.exec(s));)r=n[2]?n[2].length:0,s=s.slice(0,n.index+r)+"["+"a".repeat(n[0].length-r-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=this.options.hooks?.emStrongMask?.call({lexer:this},s)??s;let i=!1,a="";for(;e;){let r;if(i||(a=""),i=!1,this.options.extensions?.inline?.some(s=>!!(r=s.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)))continue;if((r=this.tokenizer.escape(e))||(r=this.tokenizer.tag(e))||(r=this.tokenizer.link(e))){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length);let s=t.at(-1);"text"===r.type&&s?.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if((r=this.tokenizer.emStrong(e,s,a))||(r=this.tokenizer.codespan(e))||(r=this.tokenizer.br(e))||(r=this.tokenizer.del(e))||(r=this.tokenizer.autolink(e))||!this.state.inLink&&(r=this.tokenizer.url(e))){e=e.substring(r.raw.length),t.push(r);continue}let n=e;if(this.options.extensions?.startInline){let t=1/0,r=e.slice(1),s;this.options.extensions.startInline.forEach(e=>{"number"==typeof(s=e.call({lexer:this},r))&&s>=0&&(t=Math.min(t,s))}),t<1/0&&t>=0&&(n=e.substring(0,t+1))}if(r=this.tokenizer.inlineText(n)){e=e.substring(r.raw.length),"_"!==r.raw.slice(-1)&&(a=r.raw.slice(-1)),i=!0;let s=t.at(-1);s?.type==="text"?(s.raw+=r.raw,s.text+=r.text):t.push(r);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw Error(t)}}return t}},eu=class{options;parser;constructor(e){this.options=e||n}space(e){return""}code({text:e,lang:t,escaped:r}){let s=(t||"").match(l.notSpaceStart)?.[0],n=e.replace(l.endingNewline,"")+`
`;return s?'<pre><code class="language-'+en(s)+'">'+(r?n:en(n,!0))+`</code></pre>
`:"<pre><code>"+(r?n:en(n,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,r=e.start,s="";for(let t=0;t<e.items.length;t++){let r=e.items[t];s+=this.listitem(r)}let n=t?"ol":"ul";return"<"+n+(t&&1!==r?' start="'+r+'"':"")+`>
`+s+"</"+n+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",r="";for(let t=0;t<e.header.length;t++)r+=this.tablecell(e.header[t]);t+=this.tablerow({text:r});let s="";for(let t=0;t<e.rows.length;t++){let n=e.rows[t];r="";for(let e=0;e<n.length;e++)r+=this.tablecell(n[e]);s+=this.tablerow({text:r})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+s+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${en(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){let s=this.parser.parseInline(r),n=ei(e);if(null===n)return s;let i='<a href="'+(e=n)+'"';return t&&(i+=' title="'+en(t)+'"'),i+=">"+s+"</a>"}image({href:e,title:t,text:r,tokens:s}){s&&(r=this.parser.parseInline(s,this.parser.textRenderer));let n=ei(e);if(null===n)return en(r);e=n;let i=`<img src="${e}" alt="${r}"`;return t&&(i+=` title="${en(t)}"`),i+=">"}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:en(e.text)}},ep=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}checkbox({raw:e}){return e}},ef=class e{options;renderer;textRenderer;constructor(e){this.options=e||n,this.options.renderer=this.options.renderer||new eu,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ep}static parse(t,r){return new e(r).parse(t)}static parseInline(t,r){return new e(r).parseInline(t)}parse(e){let t="";for(let r=0;r<e.length;r++){let s=e[r];if(this.options.extensions?.renderers?.[s.type]){let e=this.options.extensions.renderers[s.type].call({parser:this},s);if(!1!==e||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(s.type)){t+=e||"";continue}}switch(s.type){case"space":t+=this.renderer.space(s);break;case"hr":t+=this.renderer.hr(s);break;case"heading":t+=this.renderer.heading(s);break;case"code":t+=this.renderer.code(s);break;case"table":t+=this.renderer.table(s);break;case"blockquote":t+=this.renderer.blockquote(s);break;case"list":t+=this.renderer.list(s);break;case"checkbox":t+=this.renderer.checkbox(s);break;case"html":t+=this.renderer.html(s);break;case"def":t+=this.renderer.def(s);break;case"paragraph":t+=this.renderer.paragraph(s);break;case"text":t+=this.renderer.text(s);break;default:{let e='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw Error(e)}}}return t}parseInline(e,t=this.renderer){let r="";for(let s=0;s<e.length;s++){let n=e[s];if(this.options.extensions?.renderers?.[n.type]){let e=this.options.extensions.renderers[n.type].call({parser:this},n);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(n.type)){r+=e||"";continue}}switch(n.type){case"escape":case"text":r+=t.text(n);break;case"html":r+=t.html(n);break;case"link":r+=t.link(n);break;case"image":r+=t.image(n);break;case"checkbox":r+=t.checkbox(n);break;case"strong":r+=t.strong(n);break;case"em":r+=t.em(n);break;case"codespan":r+=t.codespan(n);break;case"br":r+=t.br(n);break;case"del":r+=t.del(n);break;default:{let e='Token with "'+n.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw Error(e)}}}return r}},ed=class{options;block;constructor(e){this.options=e||n}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?ec.lex:ec.lexInline}provideParser(){return this.block?ef.parse:ef.parseInline}},eg=new class{defaults=s();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=ef;Renderer=eu;TextRenderer=ep;Lexer=ec;Tokenizer=eh;Hooks=ed;constructor(...e){this.use(...e)}walkTokens(e,t){let r=[];for(let s of e)switch(r=r.concat(t.call(this,s)),s.type){case"table":for(let e of s.header)r=r.concat(this.walkTokens(e.tokens,t));for(let e of s.rows)for(let s of e)r=r.concat(this.walkTokens(s.tokens,t));break;case"list":r=r.concat(this.walkTokens(s.items,t));break;default:{let e=s;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach(s=>{let n=e[s].flat(1/0);r=r.concat(this.walkTokens(n,t))}):e.tokens&&(r=r.concat(this.walkTokens(e.tokens,t)))}}return r}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(e=>{let r={...e};if(r.async=this.defaults.async||r.async||!1,e.extensions&&(e.extensions.forEach(e=>{if(!e.name)throw Error("extension name required");if("renderer"in e){let r=t.renderers[e.name];r?t.renderers[e.name]=function(...t){let s=e.renderer.apply(this,t);return!1===s&&(s=r.apply(this,t)),s}:t.renderers[e.name]=e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw Error("extension level must be 'block' or 'inline'");let r=t[e.level];r?r.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)}),r.extensions=t),e.renderer){let t=this.defaults.renderer||new eu(this.defaults);for(let r in e.renderer){if(!(r in t))throw Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;let s=e.renderer[r],n=t[r];t[r]=(...e)=>{let r=s.apply(t,e);return!1===r&&(r=n.apply(t,e)),r||""}}r.renderer=t}if(e.tokenizer){let t=this.defaults.tokenizer||new eh(this.defaults);for(let r in e.tokenizer){if(!(r in t))throw Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;let s=e.tokenizer[r],n=t[r];t[r]=(...e)=>{let r=s.apply(t,e);return!1===r&&(r=n.apply(t,e)),r}}r.tokenizer=t}if(e.hooks){let t=this.defaults.hooks||new ed;for(let r in e.hooks){if(!(r in t))throw Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;let s=e.hooks[r],n=t[r];ed.passThroughHooks.has(r)?t[r]=e=>{if(this.defaults.async&&ed.passThroughHooksRespectAsync.has(r))return(async()=>{let r=await s.call(t,e);return n.call(t,r)})();let i=s.call(t,e);return n.call(t,i)}:t[r]=(...e)=>{if(this.defaults.async)return(async()=>{let r=await s.apply(t,e);return!1===r&&(r=await n.apply(t,e)),r})();let r=s.apply(t,e);return!1===r&&(r=n.apply(t,e)),r}}r.hooks=t}if(e.walkTokens){let t=this.defaults.walkTokens,s=e.walkTokens;r.walkTokens=function(e){let r=[];return r.push(s.call(this,e)),t&&(r=r.concat(t.call(this,e))),r}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ec.lex(e,t??this.defaults)}parser(e,t){return ef.parse(e,t??this.defaults)}parseMarkdown(e){return(t,r)=>{let s={...r},n={...this.defaults,...s},i=this.onError(!!n.silent,!!n.async);if(!0===this.defaults.async&&!1===s.async)return i(Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||null===t)return i(Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return i(Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(n.hooks&&(n.hooks.options=n,n.hooks.block=e),n.async)return(async()=>{let r=n.hooks?await n.hooks.preprocess(t):t,s=await (n.hooks?await n.hooks.provideLexer():e?ec.lex:ec.lexInline)(r,n),i=n.hooks?await n.hooks.processAllTokens(s):s;n.walkTokens&&await Promise.all(this.walkTokens(i,n.walkTokens));let a=await (n.hooks?await n.hooks.provideParser():e?ef.parse:ef.parseInline)(i,n);return n.hooks?await n.hooks.postprocess(a):a})().catch(i);try{n.hooks&&(t=n.hooks.preprocess(t));let r=(n.hooks?n.hooks.provideLexer():e?ec.lex:ec.lexInline)(t,n);n.hooks&&(r=n.hooks.processAllTokens(r)),n.walkTokens&&this.walkTokens(r,n.walkTokens);let s=(n.hooks?n.hooks.provideParser():e?ef.parse:ef.parseInline)(r,n);return n.hooks&&(s=n.hooks.postprocess(s)),s}catch(e){return i(e)}}}onError(e,t){return r=>{if(r.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let e="<p>An error occurred:</p><pre>"+en(r.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(r);throw r}}};function em(e,t){return eg.parse(e,t)}em.options=em.setOptions=function(e){return eg.setOptions(e),em.defaults=eg.defaults,n=em.defaults,em},em.getDefaults=s,em.defaults=n,em.use=function(...e){return eg.use(...e),em.defaults=eg.defaults,n=em.defaults,em},em.walkTokens=function(e,t){return eg.walkTokens(e,t)},em.parseInline=eg.parseInline,em.Parser=ef,em.parser=ef.parse,em.Renderer=eu,em.TextRenderer=ep,em.Lexer=ec,em.lexer=ec.lex,em.Tokenizer=eh,em.Hooks=ed,em.parse=em,em.options,em.setOptions,em.use,em.walkTokens,em.parseInline,ef.parse,ec.lex},9354:function(e,t,r){let s,n,i,a;r.d(t,{M:function(){return c}});var o=r(1448);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n||(n=new o._12(2,2,1,1)),i||(i=new o.jyz({uniforms:{blitTexture:new o.xWb(e)},vertexShader:"\n			varying vec2 vUv;\n			void main(){\n				vUv = uv;\n				gl_Position = vec4(position.xy * 1.0,0.,.999999);\n			}",fragmentShader:"\n			uniform sampler2D blitTexture; \n			varying vec2 vUv;\n\n			void main(){ \n				gl_FragColor = vec4(vUv.xy, 0, 1);\n				\n				#ifdef IS_SRGB\n				gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );\n				#else\n				gl_FragColor = texture2D( blitTexture, vUv);\n				#endif\n			}"})),i.uniforms.blitTexture.value=e,i.defines.IS_SRGB=e.colorSpace==o.KI_,i.needsUpdate=!0,a||((a=new o.Kj0(n,i)).frustrumCulled=!1);let l=new o.cPb,h=new o.xsS;h.add(a),null===r&&(r=s=new o.CP7({antialias:!1}));let c=Math.min(e.image.width,t),u=Math.min(e.image.height,t);r.setSize(c,u),r.clear(),r.render(h,l);let p=document.createElement("canvas"),f=p.getContext("2d");p.width=c,p.height=u,f.drawImage(r.domElement,0,0,c,u);let d=new o.ROQ(p);return d.minFilter=e.minFilter,d.magFilter=e.magFilter,d.wrapS=e.wrapS,d.wrapT=e.wrapT,d.name=e.name,s&&(s.forceContextLoss(),s.dispose(),s=null),d}let h={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class c{register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,s){let n=new A,i=[];for(let e=0,t=this.pluginCallbacks.length;e<t;e++)i.push(this.pluginCallbacks[e](n));n.setPlugins(i),n.write(e,t,s).catch(r)}parseAsync(e,t){let r=this;return new Promise(function(s,n){r.parse(e,s,n,t)})}constructor(){this.pluginCallbacks=[],this.register(function(e){return new T(e)}),this.register(function(e){return new k(e)}),this.register(function(e){return new R(e)}),this.register(function(e){return new v(e)}),this.register(function(e){return new M(e)}),this.register(function(e){return new S(e)}),this.register(function(e){return new E(e)}),this.register(function(e){return new _(e)}),this.register(function(e){return new I(e)}),this.register(function(e){return new L(e)}),this.register(function(e){return new U(e)}),this.register(function(e){return new N(e)}),this.register(function(e){return new O(e)})}}let u={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},p="KHR_mesh_quantization",f={};f[o.TyD]=u.NEAREST,f[o.YLQ]=u.NEAREST_MIPMAP_NEAREST,f[o.aH4]=u.NEAREST_MIPMAP_LINEAR,f[o.wem]=u.LINEAR,f[o.qyh]=u.LINEAR_MIPMAP_NEAREST,f[o.D1R]=u.LINEAR_MIPMAP_LINEAR,f[o.uWy]=u.CLAMP_TO_EDGE,f[o.rpg]=u.REPEAT,f[o.OoA]=u.MIRRORED_REPEAT;let d={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},g=new o.Ilk;function m(e,t){return e.length===t.length&&e.every(function(e,r){return e===t[r]})}function x(e){return 4*Math.ceil(e/4)}function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=x(e.byteLength);if(r!==e.byteLength){let s=new Uint8Array(r);if(s.set(new Uint8Array(e)),0!==t)for(let n=e.byteLength;n<r;n++)s[n]=t;return s.buffer}return e}function y(){return"undefined"==typeof document&&"undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")}function w(e,t){let r;return void 0!==e.toBlob?new Promise(r=>e.toBlob(r,t)):("image/jpeg"===t?r=.92:"image/webp"===t&&(r=.8),e.convertToBlob({type:t,quality:r}))}class A{setPlugins(e){this.plugins=e}async write(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);let s=this.buffers,n=this.json;r=this.options;let i=this.extensionsUsed,a=this.extensionsRequired,o=new Blob(s,{type:"application/octet-stream"}),l=Object.keys(i),h=Object.keys(a);if(l.length>0&&(n.extensionsUsed=l),h.length>0&&(n.extensionsRequired=h),n.buffers&&n.buffers.length>0&&(n.buffers[0].byteLength=o.size),!0===r.binary){let e=new FileReader;e.readAsArrayBuffer(o),e.onloadend=function(){var r;let s=b(e.result),i=new DataView(new ArrayBuffer(8));i.setUint32(0,s.byteLength,!0),i.setUint32(4,5130562,!0);let a=b((r=JSON.stringify(n),new TextEncoder().encode(r).buffer),32),o=new DataView(new ArrayBuffer(8));o.setUint32(0,a.byteLength,!0),o.setUint32(4,1313821514,!0);let l=new ArrayBuffer(12),h=new DataView(l);h.setUint32(0,1179937895,!0),h.setUint32(4,2,!0);let c=12+o.byteLength+a.byteLength+i.byteLength+s.byteLength;h.setUint32(8,c,!0);let u=new Blob([l,o,a,i,s],{type:"application/octet-stream"}),p=new FileReader;p.readAsArrayBuffer(u),p.onloadend=function(){t(p.result)}}}else if(n.buffers&&n.buffers.length>0){let e=new FileReader;e.readAsDataURL(o),e.onloadend=function(){let r=e.result;n.buffers[0].uri=r,t(n)}}else t(n)}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;let r=this.options,s=this.extensionsUsed;try{let n=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&n.gltfExtensions){for(let e in void 0===t.extensions&&(t.extensions={}),n.gltfExtensions)t.extensions[e]=n.gltfExtensions[e],s[e]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}getUID(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1===this.uids.has(e)){let t=new Map;t.set(!0,this.uid++),t.set(!1,this.uid++),this.uids.set(e,t)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;let t=new o.Pa4;for(let r=0,s=e.count;r<s;r++)if(Math.abs(t.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){let t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);let r=e.clone(),s=new o.Pa4;for(let e=0,t=r.count;e<t;e++)s.fromBufferAttribute(r,e),0===s.x&&0===s.y&&0===s.z?s.setX(1):s.normalize(),r.setXYZ(e,s.x,s.y,s.z);return t.attributesNormalized.set(e,r),r}applyTextureTransform(e,t){let r=!1,s={};(0!==t.offset.x||0!==t.offset.y)&&(s.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(s.rotation=t.rotation,r=!0),(1!==t.repeat.x||1!==t.repeat.y)&&(s.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=s,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function r(e){return e.colorSpace===o.KI_?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof o.EB7&&(e=l(e)),t instanceof o.EB7&&(t=l(t));let s=e?e.image:null,n=t?t.image:null,i=Math.max(s?s.width:0,n?n.width:0),a=Math.max(s?s.height:0,n?n.height:0),h=y();h.width=i,h.height=a;let c=h.getContext("2d");c.fillStyle="#00ffff",c.fillRect(0,0,i,a);let u=c.getImageData(0,0,i,a);if(s){c.drawImage(s,0,0,i,a);let t=r(e),n=c.getImageData(0,0,i,a).data;for(let e=2;e<n.length;e+=4)u.data[e]=256*t(n[e]/256)}if(n){c.drawImage(n,0,0,i,a);let e=r(t),s=c.getImageData(0,0,i,a).data;for(let t=1;t<s.length;t+=4)u.data[t]=256*e(s[t]/256)}c.putImageData(u,0,0);let p=(e||t).clone();return p.source=new o.Hw6(h),p.colorSpace=o.aCh,p.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),p}processBuffer(e){let t=this.json,r=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),r.push(e),0}processBufferView(e,t,r,s,n){let i;let a=this.json;switch(a.bufferViews||(a.bufferViews=[]),t){case u.BYTE:case u.UNSIGNED_BYTE:i=1;break;case u.SHORT:case u.UNSIGNED_SHORT:i=2;break;default:i=4}let l=x(s*e.itemSize*i),h=new DataView(new ArrayBuffer(l)),c=0;for(let n=r;n<r+s;n++)for(let r=0;r<e.itemSize;r++){let s;e.itemSize>4?s=e.array[n*e.itemSize+r]:(0===r?s=e.getX(n):1===r?s=e.getY(n):2===r?s=e.getZ(n):3===r&&(s=e.getW(n)),!0===e.normalized&&(s=o.M8C.normalize(s,e.array))),t===u.FLOAT?h.setFloat32(c,s,!0):t===u.INT?h.setInt32(c,s,!0):t===u.UNSIGNED_INT?h.setUint32(c,s,!0):t===u.SHORT?h.setInt16(c,s,!0):t===u.UNSIGNED_SHORT?h.setUint16(c,s,!0):t===u.BYTE?h.setInt8(c,s):t===u.UNSIGNED_BYTE&&h.setUint8(c,s),c+=i}let p={buffer:this.processBuffer(h.buffer),byteOffset:this.byteOffset,byteLength:l};return void 0!==n&&(p.target=n),n===u.ARRAY_BUFFER&&(p.byteStride=e.itemSize*i),this.byteOffset+=l,a.bufferViews.push(p),{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){let t=this,r=t.json;return r.bufferViews||(r.bufferViews=[]),new Promise(function(s){let n=new FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){let e=b(n.result),i={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,s(r.bufferViews.push(i)-1)}})}processAccessor(e,t,r,s){let n,i;let a=this.json;if(e.array.constructor===Float32Array)n=u.FLOAT;else if(e.array.constructor===Int32Array)n=u.INT;else if(e.array.constructor===Uint32Array)n=u.UNSIGNED_INT;else if(e.array.constructor===Int16Array)n=u.SHORT;else if(e.array.constructor===Uint16Array)n=u.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)n=u.BYTE;else if(e.array.constructor===Uint8Array)n=u.UNSIGNED_BYTE;else throw Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(void 0===r&&(r=0),(void 0===s||s===1/0)&&(s=e.count),0===s)return null;let l=function(e,t,r){let s={min:Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let n=t;n<t+r;n++)for(let t=0;t<e.itemSize;t++){let r;e.itemSize>4?r=e.array[n*e.itemSize+t]:(0===t?r=e.getX(n):1===t?r=e.getY(n):2===t?r=e.getZ(n):3===t&&(r=e.getW(n)),!0===e.normalized&&(r=o.M8C.normalize(r,e.array))),s.min[t]=Math.min(s.min[t],r),s.max[t]=Math.max(s.max[t],r)}return s}(e,r,s);void 0!==t&&(i=e===t.index?u.ELEMENT_ARRAY_BUFFER:u.ARRAY_BUFFER);let h=this.processBufferView(e,n,r,s,i),c={bufferView:h.id,byteOffset:h.byteOffset,componentType:n,count:s,max:l.max,min:l.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(c.normalized=!0),a.accessors||(a.accessors=[]),a.accessors.push(c)-1}processImage(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png";if(null!==e){let n=this,i=n.cache,a=n.json,l=n.options,h=n.pending;i.images.has(e)||i.images.set(e,{});let c=i.images.get(e),u=s+":flipY/"+r.toString();if(void 0!==c[u])return c[u];a.images||(a.images=[]);let p={mimeType:s},f=y();f.width=Math.min(e.width,l.maxTextureSize),f.height=Math.min(e.height,l.maxTextureSize);let d=f.getContext("2d");if(!0===r&&(d.translate(0,f.height),d.scale(1,-1)),void 0!==e.data){t!==o.wk1&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>l.maxTextureSize||e.height>l.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);let r=new Uint8ClampedArray(e.height*e.width*4);for(let t=0;t<r.length;t+=4)r[t+0]=e.data[t+0],r[t+1]=e.data[t+1],r[t+2]=e.data[t+2],r[t+3]=e.data[t+3];d.putImageData(new ImageData(r,e.width,e.height),0,0)}else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap)d.drawImage(e,0,0,f.width,f.height);else throw Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement or ImageBitmap.");!0===l.binary?h.push(w(f,s).then(e=>n.processBufferViewImage(e)).then(e=>{p.bufferView=e})):void 0!==f.toDataURL?p.uri=f.toDataURL(s):h.push(w(f,s).then(e=>new FileReader().readAsDataURL(e)).then(e=>{p.uri=e}));let g=a.images.push(p)-1;return c[u]=g,g}throw Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){let t=this.json;t.samplers||(t.samplers=[]);let r={magFilter:f[e.magFilter],minFilter:f[e.minFilter],wrapS:f[e.wrapS],wrapT:f[e.wrapT]};return t.samplers.push(r)-1}processTexture(e){let t=this.options,r=this.cache,s=this.json;if(r.textures.has(e))return r.textures.get(e);s.textures||(s.textures=[]),e instanceof o.EB7&&(e=l(e,t.maxTextureSize));let n=e.userData.mimeType;"image/webp"===n&&(n="image/png");let i={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,n)};e.name&&(i.name=e.name),this._invokeAll(function(t){t.writeTexture&&t.writeTexture(e,i)});let a=s.textures.push(i)-1;return r.textures.set(e,a),a}processMaterial(e){let t=this.cache,r=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;r.materials||(r.materials=[]);let s={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");let n=e.color.toArray().concat([e.opacity]);if(m(n,[1,1,1,1])||(s.pbrMetallicRoughness.baseColorFactor=n),e.isMeshStandardMaterial?(s.pbrMetallicRoughness.metallicFactor=e.metalness,s.pbrMetallicRoughness.roughnessFactor=e.roughness):(s.pbrMetallicRoughness.metallicFactor=.5,s.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){let t=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),r={index:this.processTexture(t),channel:t.channel};this.applyTextureTransform(r,t),s.pbrMetallicRoughness.metallicRoughnessTexture=r}if(e.map){let t={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(t,e.map),s.pbrMetallicRoughness.baseColorTexture=t}if(e.emissive){let t=e.emissive;if(Math.max(t.r,t.g,t.b)>0&&(s.emissiveFactor=e.emissive.toArray()),e.emissiveMap){let t={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(t,e.emissiveMap),s.emissiveTexture=t}}if(e.normalMap){let t={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(t.scale=e.normalScale.x),this.applyTextureTransform(t,e.normalMap),s.normalTexture=t}if(e.aoMap){let t={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(t.strength=e.aoMapIntensity),this.applyTextureTransform(t,e.aoMap),s.occlusionTexture=t}e.transparent?s.alphaMode="BLEND":e.alphaTest>0&&(s.alphaMode="MASK",s.alphaCutoff=e.alphaTest),e.side===o.ehD&&(s.doubleSided=!0),""!==e.name&&(s.name=e.name),this.serializeUserData(e,s),this._invokeAll(function(t){t.writeMaterial&&t.writeMaterial(e,s)});let i=r.materials.push(s)-1;return t.materials.set(e,i),i}processMesh(e){let t;let r=this.cache,s=this.json,n=[e.geometry.uuid];if(Array.isArray(e.material))for(let t=0,r=e.material.length;t<r;t++)n.push(e.material[t].uuid);else n.push(e.material.uuid);let i=n.join(":");if(r.meshes.has(i))return r.meshes.get(i);let a=e.geometry;t=e.isLineSegments?u.LINES:e.isLineLoop?u.LINE_LOOP:e.isLine?u.LINE_STRIP:e.isPoints?u.POINTS:e.material.wireframe?u.LINES:u.TRIANGLES;let l={},h={},c=[],p=[],f={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},d=a.getAttribute("normal");void 0===d||this.isNormalizedNormalAttribute(d)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(d)));let g=null;for(let e in a.attributes){if("morph"===e.slice(0,5))continue;let t=a.attributes[e];if(e=f[e]||e.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(e)||(e="_"+e),r.attributes.has(this.getUID(t))){h[e]=r.attributes.get(this.getUID(t));continue}g=null;let s=t.array;"JOINTS_0"!==e||s instanceof Uint16Array||s instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),g=new o.TlE(new Uint16Array(s),t.itemSize,t.normalized));let n=this.processAccessor(g||t,a);null!==n&&(e.startsWith("_")||this.detectMeshQuantization(e,t),h[e]=n,r.attributes.set(this.getUID(t),n))}if(void 0!==d&&a.setAttribute("normal",d),0===Object.keys(h).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){let t=[],s=[],n={};if(void 0!==e.morphTargetDictionary)for(let t in e.morphTargetDictionary)n[e.morphTargetDictionary[t]]=t;for(let i=0;i<e.morphTargetInfluences.length;++i){let o={},l=!1;for(let e in a.morphAttributes){if("position"!==e&&"normal"!==e){l||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),l=!0);continue}let t=a.morphAttributes[e][i],s=e.toUpperCase(),n=a.attributes[e];if(r.attributes.has(this.getUID(t,!0))){o[s]=r.attributes.get(this.getUID(t,!0));continue}let h=t.clone();if(!a.morphTargetsRelative)for(let e=0,r=t.count;e<r;e++)for(let r=0;r<t.itemSize;r++)0===r&&h.setX(e,t.getX(e)-n.getX(e)),1===r&&h.setY(e,t.getY(e)-n.getY(e)),2===r&&h.setZ(e,t.getZ(e)-n.getZ(e)),3===r&&h.setW(e,t.getW(e)-n.getW(e));o[s]=this.processAccessor(h,a),r.attributes.set(this.getUID(n,!0),o[s])}p.push(o),t.push(e.morphTargetInfluences[i]),void 0!==e.morphTargetDictionary&&s.push(n[i])}l.weights=t,s.length>0&&(l.extras={},l.extras.targetNames=s)}let m=Array.isArray(e.material);if(m&&0===a.groups.length)return null;let x=!1;if(m&&null===a.index){let e=[];for(let t=0,r=a.attributes.position.count;t<r;t++)e[t]=t;a.setIndex(e),x=!0}let b=m?e.material:[e.material],y=m?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let e=0,s=y.length;e<s;e++){let s={mode:t,attributes:h};if(this.serializeUserData(a,s),p.length>0&&(s.targets=p),null!==a.index){let t=this.getUID(a.index);(void 0!==y[e].start||void 0!==y[e].count)&&(t+=":"+y[e].start+":"+y[e].count),r.attributes.has(t)?s.indices=r.attributes.get(t):(s.indices=this.processAccessor(a.index,a,y[e].start,y[e].count),r.attributes.set(t,s.indices)),null===s.indices&&delete s.indices}let n=this.processMaterial(b[y[e].materialIndex]);null!==n&&(s.material=n),c.push(s)}!0===x&&a.setIndex(null),l.primitives=c,s.meshes||(s.meshes=[]),this._invokeAll(function(t){t.writeMesh&&t.writeMesh(e,l)});let w=s.meshes.push(l)-1;return r.meshes.set(i,w),w}detectMeshQuantization(e,t){let r;if(this.extensionsUsed[p])return;switch(t.array.constructor){case Int8Array:r="byte";break;case Uint8Array:r="unsigned byte";break;case Int16Array:r="short";break;case Uint16Array:r="unsigned short";break;default:return}t.normalized&&(r+=" normalized");let s=e.split("_",1)[0];h[s]&&h[s].includes(r)&&(this.extensionsUsed[p]=!0,this.extensionsRequired[p]=!0)}processCamera(e){let t=this.json;t.cameras||(t.cameras=[]);let r=e.isOrthographicCamera,s={type:r?"orthographic":"perspective"};return r?s.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:s.perspective={aspectRatio:e.aspect,yfov:o.M8C.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(s.name=e.type),t.cameras.push(s)-1}processAnimation(e,t){let r=this.json,s=this.nodeMap;r.animations||(r.animations=[]);let n=(e=c.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,i=[],a=[];for(let e=0;e<n.length;++e){let r;let l=n[e],h=o.iUV.parseTrackName(l.name),c=o.iUV.findNode(t,h.nodeName),u=d[h.propertyName];if("bones"===h.objectName&&(c=!0===c.isSkinnedMesh?c.skeleton.getBoneByName(h.objectIndex):void 0),!c||!u)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',l.name),null;let p=l.values.length/l.times.length;u===d.morphTargetInfluences&&(p/=c.morphTargetInfluences.length),!0===l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(r="CUBICSPLINE",p/=3):r=l.getInterpolation()===o.Syv?"STEP":"LINEAR",a.push({input:this.processAccessor(new o.TlE(l.times,1)),output:this.processAccessor(new o.TlE(l.values,p)),interpolation:r}),i.push({sampler:a.length-1,target:{node:s.get(c),path:u}})}return r.animations.push({name:e.name||"clip_"+r.animations.length,samplers:a,channels:i}),r.animations.length-1}processSkin(e){let t=this.json,r=this.nodeMap,s=t.nodes[r.get(e)],n=e.skeleton;if(void 0===n)return null;let i=e.skeleton.bones[0];if(void 0===i)return null;let a=[],l=new Float32Array(16*n.bones.length),h=new o.yGw;for(let t=0;t<n.bones.length;++t)a.push(r.get(n.bones[t])),h.copy(n.boneInverses[t]),h.multiply(e.bindMatrix).toArray(l,16*t);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new o.TlE(l,16)),joints:a,skeleton:r.get(i)}),s.skin=t.skins.length-1}processNode(e){let t=this.json,r=this.options,s=this.nodeMap;t.nodes||(t.nodes=[]);let n={};if(r.trs){let t=e.quaternion.toArray(),r=e.position.toArray(),s=e.scale.toArray();m(t,[0,0,0,1])||(n.rotation=t),m(r,[0,0,0])||(n.translation=r),m(s,[1,1,1])||(n.scale=s)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===m(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(n.matrix=e.matrix.elements);if(""!==e.name&&(n.name=String(e.name)),this.serializeUserData(e,n),e.isMesh||e.isLine||e.isPoints){let t=this.processMesh(e);null!==t&&(n.mesh=t)}else e.isCamera&&(n.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){let t=[];for(let s=0,n=e.children.length;s<n;s++){let n=e.children[s];if(n.visible||!1===r.onlyVisible){let e=this.processNode(n);null!==e&&t.push(e)}}t.length>0&&(n.children=t)}this._invokeAll(function(t){t.writeNode&&t.writeNode(e,n)});let i=t.nodes.push(n)-1;return s.set(e,i),i}processScene(e){let t=this.json,r=this.options;t.scenes||(t.scenes=[],t.scene=0);let s={};""!==e.name&&(s.name=e.name),t.scenes.push(s);let n=[];for(let t=0,s=e.children.length;t<s;t++){let s=e.children[t];if(s.visible||!1===r.onlyVisible){let e=this.processNode(s);null!==e&&n.push(e)}}n.length>0&&(s.nodes=n),this.serializeUserData(e,s)}processObjects(e){let t=new o.xsS;t.name="AuxScene";for(let r=0;r<e.length;r++)t.children.push(e[r]);this.processScene(t)}processInput(e){let t=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(t){t.beforeParse&&t.beforeParse(e)});let r=[];for(let t=0;t<e.length;t++)e[t]instanceof o.xsS?this.processScene(e[t]):r.push(e[t]);r.length>0&&this.processObjects(r);for(let e=0;e<this.skins.length;++e)this.processSkin(this.skins[e]);for(let r=0;r<t.animations.length;++r)this.processAnimation(t.animations[r],e[0]);this._invokeAll(function(t){t.afterParse&&t.afterParse(e)})}_invokeAll(e){for(let t=0,r=this.plugins.length;t<r;t++)e(this.plugins[t])}constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}}class T{writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}let r=this.writer,s=r.json,n=r.extensionsUsed,i={};e.name&&(i.name=e.name),i.color=e.color.toArray(),i.intensity=e.intensity,e.isDirectionalLight?i.type="directional":e.isPointLight?(i.type="point",e.distance>0&&(i.range=e.distance)):e.isSpotLight&&(i.type="spot",e.distance>0&&(i.range=e.distance),i.spot={},i.spot.innerConeAngle=(1-e.penumbra)*e.angle,i.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||0!==e.target.position.x||0!==e.target.position.y||-1!==e.target.position.z)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),n[this.name]||(s.extensions=s.extensions||{},s.extensions[this.name]={lights:[]},n[this.name]=!0);let a=s.extensions[this.name].lights;a.push(i),t.extensions=t.extensions||{},t.extensions[this.name]={light:a.length-1}}constructor(e){this.writer=e,this.name="KHR_lights_punctual"}}class k{writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;let r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}constructor(e){this.writer=e,this.name="KHR_materials_unlit"}}class E{writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;let r=this.writer,s=r.extensionsUsed,n={};if(n.clearcoatFactor=e.clearcoat,e.clearcoatMap){let t={index:r.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};r.applyTextureTransform(t,e.clearcoatMap),n.clearcoatTexture=t}if(n.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){let t={index:r.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};r.applyTextureTransform(t,e.clearcoatRoughnessMap),n.clearcoatRoughnessTexture=t}if(e.clearcoatNormalMap){let t={index:r.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};r.applyTextureTransform(t,e.clearcoatNormalMap),n.clearcoatNormalTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}}class _{writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;let r=this.writer,s=r.extensionsUsed,n={};if(n.iridescenceFactor=e.iridescence,e.iridescenceMap){let t={index:r.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};r.applyTextureTransform(t,e.iridescenceMap),n.iridescenceTexture=t}if(n.iridescenceIor=e.iridescenceIOR,n.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],n.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){let t={index:r.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};r.applyTextureTransform(t,e.iridescenceThicknessMap),n.iridescenceThicknessTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}}class R{writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;let r=this.writer,s=r.extensionsUsed,n={};if(n.transmissionFactor=e.transmission,e.transmissionMap){let t={index:r.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};r.applyTextureTransform(t,e.transmissionMap),n.transmissionTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_transmission"}}class v{writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;let r=this.writer,s=r.extensionsUsed,n={};if(n.thicknessFactor=e.thickness,e.thicknessMap){let t={index:r.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};r.applyTextureTransform(t,e.thicknessMap),n.thicknessTexture=t}n.attenuationDistance=e.attenuationDistance,n.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_volume"}}class M{writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;let r=this.writer.extensionsUsed,s={};s.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_ior"}}class S{writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(g)&&!e.specularIntensityMap&&!e.specularColorMap)return;let r=this.writer,s=r.extensionsUsed,n={};if(e.specularIntensityMap){let t={index:r.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};r.applyTextureTransform(t,e.specularIntensityMap),n.specularTexture=t}if(e.specularColorMap){let t={index:r.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};r.applyTextureTransform(t,e.specularColorMap),n.specularColorTexture=t}n.specularFactor=e.specularIntensity,n.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_specular"}}class I{writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;let r=this.writer,s=r.extensionsUsed,n={};if(e.sheenRoughnessMap){let t={index:r.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};r.applyTextureTransform(t,e.sheenRoughnessMap),n.sheenRoughnessTexture=t}if(e.sheenColorMap){let t={index:r.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};r.applyTextureTransform(t,e.sheenColorMap),n.sheenColorTexture=t}n.sheenRoughnessFactor=e.sheenRoughness,n.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_sheen"}}class L{writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;let r=this.writer,s=r.extensionsUsed,n={};if(e.anisotropyMap){let t={index:r.processTexture(e.anisotropyMap)};r.applyTextureTransform(t,e.anisotropyMap),n.anisotropyTexture=t}n.anisotropyStrength=e.anisotropy,n.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}}class U{writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;let r=this.writer.extensionsUsed,s={};s.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=s,r[this.name]=!0}constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}}class N{writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.bumpScale&&!e.bumpMap)return;let r=this.writer,s=r.extensionsUsed,n={};if(e.bumpMap){let t={index:r.processTexture(e.bumpMap),texCoord:e.bumpMap.channel};r.applyTextureTransform(t,e.bumpMap),n.bumpTexture=t}n.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=n,s[this.name]=!0}constructor(e){this.writer=e,this.name="EXT_materials_bump"}}class O{writeNode(e,t){if(!e.isInstancedMesh)return;let r=this.writer,s=new Float32Array(3*e.count),n=new Float32Array(4*e.count),i=new Float32Array(3*e.count),a=new o.yGw,l=new o.Pa4,h=new o._fP,c=new o.Pa4;for(let t=0;t<e.count;t++)e.getMatrixAt(t,a),a.decompose(l,h,c),l.toArray(s,3*t),h.toArray(n,4*t),c.toArray(i,3*t);let u={TRANSLATION:r.processAccessor(new o.TlE(s,3)),ROTATION:r.processAccessor(new o.TlE(n,4)),SCALE:r.processAccessor(new o.TlE(i,3))};e.instanceColor&&(u._COLOR_0=r.processAccessor(e.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:u},r.extensionsUsed[this.name]=!0,r.extensionsRequired[this.name]=!0}constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}}c.Utils={insertKeyframe:function(e,t){let r;let s=e.getValueSize(),n=new e.TimeBufferType(e.times.length+1),i=new e.ValueBufferType(e.values.length+s),a=e.createInterpolant(new e.ValueBufferType(s));if(0===e.times.length){n[0]=t;for(let e=0;e<s;e++)i[e]=0;r=0}else if(t<e.times[0]){if(.001>Math.abs(e.times[0]-t))return 0;n[0]=t,n.set(e.times,1),i.set(a.evaluate(t),0),i.set(e.values,s),r=0}else if(t>e.times[e.times.length-1]){if(.001>Math.abs(e.times[e.times.length-1]-t))return e.times.length-1;n[n.length-1]=t,n.set(e.times,0),i.set(e.values,0),i.set(a.evaluate(t),e.values.length),r=n.length-1}else for(let o=0;o<e.times.length;o++){if(.001>Math.abs(e.times[o]-t))return o;if(e.times[o]<t&&e.times[o+1]>t){n.set(e.times.slice(0,o+1),0),n[o+1]=t,n.set(e.times.slice(o+1),o+2),i.set(e.values.slice(0,(o+1)*s),0),i.set(a.evaluate(t),(o+1)*s),i.set(e.values.slice((o+1)*s),(o+2)*s),r=o+1;break}}return e.times=n,e.values=i,r},mergeMorphTargetTracks:function(e,t){let r=[],s={},n=e.tracks;for(let e=0;e<n.length;++e){let i,a=n[e],l=o.iUV.parseTrackName(a.name),h=o.iUV.findNode(t,l.nodeName);if("morphTargetInfluences"!==l.propertyName||void 0===l.propertyIndex){r.push(a);continue}if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(a=a.clone()).setInterpolation(o.NMF)}let c=h.morphTargetInfluences.length,u=h.morphTargetDictionary[l.propertyIndex];if(void 0===u)throw Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);if(void 0===s[h.uuid]){let e=new(i=a.clone()).ValueBufferType(c*i.times.length);for(let t=0;t<i.times.length;t++)e[t*c+u]=i.values[t];i.name=(l.nodeName||"")+".morphTargetInfluences",i.values=e,s[h.uuid]=i,r.push(i);continue}let p=a.createInterpolant(new a.ValueBufferType(1));i=s[h.uuid];for(let e=0;e<i.times.length;e++)i.values[e*c+u]=p.evaluate(i.times[e]);for(let e=0;e<a.times.length;e++){let t=this.insertKeyframe(i,a.times[e]);i.values[t*c+u]=a.values[e]}}return e.tracks=r,e}}},4161:function(e,t,r){r.d(t,{h:function(){return n}});var s=r(1448);class n{parse(e){let t="",r=0,n=0,i=0,a=new s.Pa4,o=new s.Ilk,l=new s.Pa4,h=new s.FM8,c=[];return e.traverse(function(e){!0===e.isMesh&&function(e){let o=0,u=0,p=0,f=e.geometry,d=new s.Vkp,g=f.getAttribute("position"),m=f.getAttribute("normal"),x=f.getAttribute("uv"),b=f.getIndex();if(t+="o "+e.name+"\n",e.material&&e.material.name&&(t+="usemtl "+e.material.name+"\n"),void 0!==g)for(let r=0,s=g.count;r<s;r++,o++)a.fromBufferAttribute(g,r),a.applyMatrix4(e.matrixWorld),t+="v "+a.x+" "+a.y+" "+a.z+"\n";if(void 0!==x)for(let e=0,r=x.count;e<r;e++,p++)h.fromBufferAttribute(x,e),t+="vt "+h.x+" "+h.y+"\n";if(void 0!==m){d.getNormalMatrix(e.matrixWorld);for(let e=0,r=m.count;e<r;e++,u++)l.fromBufferAttribute(m,e),l.applyMatrix3(d).normalize(),t+="vn "+l.x+" "+l.y+" "+l.z+"\n"}if(null!==b)for(let e=0,s=b.count;e<s;e+=3){for(let t=0;t<3;t++){let s=b.getX(e+t)+1;c[t]=r+s+(m||x?"/"+(x?n+s:"")+(m?"/"+(i+s):""):"")}t+="f "+c.join(" ")+"\n"}else for(let e=0,s=g.count;e<s;e+=3){for(let t=0;t<3;t++){let s=e+t+1;c[t]=r+s+(m||x?"/"+(x?n+s:"")+(m?"/"+(i+s):""):"")}t+="f "+c.join(" ")+"\n"}r+=o,n+=p,i+=u}(e),!0===e.isLine&&function(e){let s=0,n=e.geometry,i=e.type,o=n.getAttribute("position");if(t+="o "+e.name+"\n",void 0!==o)for(let r=0,n=o.count;r<n;r++,s++)a.fromBufferAttribute(o,r),a.applyMatrix4(e.matrixWorld),t+="v "+a.x+" "+a.y+" "+a.z+"\n";if("Line"===i){t+="l ";for(let e=1,s=o.count;e<=s;e++)t+=r+e+" ";t+="\n"}if("LineSegments"===i)for(let e=1,s=e+1,n=o.count;e<n;e+=2,s=e+1)t+="l "+(r+e)+" "+(r+s)+"\n";r+=s}(e),!0===e.isPoints&&function(e){let s=0,n=e.geometry,i=n.getAttribute("position"),l=n.getAttribute("color");if(t+="o "+e.name+"\n",void 0!==i){for(let r=0,n=i.count;r<n;r++,s++)a.fromBufferAttribute(i,r),a.applyMatrix4(e.matrixWorld),t+="v "+a.x+" "+a.y+" "+a.z,void 0!==l&&(o.fromBufferAttribute(l,r).convertLinearToSRGB(),t+=" "+o.r+" "+o.g+" "+o.b),t+="\n";t+="p ";for(let e=1,s=i.count;e<=s;e++)t+=r+e+" ";t+="\n"}r+=s}(e)}),t}}},6775:function(e,t,r){r.d(t,{V:function(){return n}});var s=r(1448);class n{parse(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function n(t){e.traverse(function(e){if(!0===e.isMesh||e.isPoints){let r=e.geometry;!0===r.hasAttribute("position")&&t(e,r)}})}let i=(r=Object.assign({binary:!1,excludeAttributes:[],littleEndian:!1},r)).excludeAttributes,a=!0,o=!1,l=!1,h=!1,c=0,u=0;e.traverse(function(e){if(!0===e.isMesh){let t=e.geometry,r=t.getAttribute("position"),s=t.getAttribute("normal"),n=t.getAttribute("uv"),i=t.getAttribute("color"),a=t.getIndex();void 0!==r&&(c+=r.count,u+=a?a.count/3:r.count/3,void 0!==s&&(o=!0),void 0!==n&&(h=!0),void 0!==i&&(l=!0))}else if(e.isPoints){let t=e.geometry,r=t.getAttribute("position"),s=t.getAttribute("normal"),n=t.getAttribute("color");c+=r.count,void 0!==s&&(o=!0),void 0!==n&&(l=!0),a=!1}});let p=new s.Ilk;if(a=a&&-1===i.indexOf("index"),o=o&&-1===i.indexOf("normal"),l=l&&-1===i.indexOf("color"),h=h&&-1===i.indexOf("uv"),a&&u!==Math.floor(u))return console.error("PLYExporter: Failed to generate a valid PLY file with triangle indices because the number of indices is not divisible by 3."),null;let f="ply\n"+"format ".concat(r.binary?r.littleEndian?"binary_little_endian":"binary_big_endian":"ascii"," 1.0\n")+"element vertex ".concat(c,"\n")+"property float x\nproperty float y\nproperty float z\n";!0===o&&(f+="property float nx\nproperty float ny\nproperty float nz\n"),!0===h&&(f+="property float s\nproperty float t\n"),!0===l&&(f+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),!0===a&&(f+="element face ".concat(u,"\n")+"property list uchar int vertex_index\n"),f+="end_header\n";let d=new s.Pa4,g=new s.Vkp,m=null;if(!0===r.binary){let e=new TextEncoder().encode(f),t=c*(12+(o?12:0)+(l?3:0)+(h?8:0)),s=a?13*u:0,i=new DataView(new ArrayBuffer(e.length+t+s));new Uint8Array(i.buffer).set(e,0);let x=e.length,b=e.length+t,y=0;n(function(e,t){let s=t.getAttribute("position"),n=t.getAttribute("normal"),c=t.getAttribute("uv"),u=t.getAttribute("color"),f=t.getIndex();g.getNormalMatrix(e.matrixWorld);for(let t=0,a=s.count;t<a;t++)d.fromBufferAttribute(s,t),d.applyMatrix4(e.matrixWorld),i.setFloat32(x,d.x,r.littleEndian),x+=4,i.setFloat32(x,d.y,r.littleEndian),x+=4,i.setFloat32(x,d.z,r.littleEndian),x+=4,!0===o&&(null!=n?(d.fromBufferAttribute(n,t),d.applyMatrix3(g).normalize(),i.setFloat32(x,d.x,r.littleEndian),x+=4,i.setFloat32(x,d.y,r.littleEndian),x+=4,i.setFloat32(x,d.z,r.littleEndian)):(i.setFloat32(x,0,r.littleEndian),x+=4,i.setFloat32(x,0,r.littleEndian),x+=4,i.setFloat32(x,0,r.littleEndian)),x+=4),!0===h&&(null!=c?(i.setFloat32(x,c.getX(t),r.littleEndian),x+=4,i.setFloat32(x,c.getY(t),r.littleEndian)):(i.setFloat32(x,0,r.littleEndian),x+=4,i.setFloat32(x,0,r.littleEndian)),x+=4),!0===l&&(null!=u?(p.fromBufferAttribute(u,t).convertLinearToSRGB(),i.setUint8(x,Math.floor(255*p.r)),x+=1,i.setUint8(x,Math.floor(255*p.g)),x+=1,i.setUint8(x,Math.floor(255*p.b))):(i.setUint8(x,255),x+=1,i.setUint8(x,255),x+=1,i.setUint8(x,255)),x+=1);if(!0===a){if(null!==f)for(let e=0,t=f.count;e<t;e+=3)i.setUint8(b,3),b+=1,i.setUint32(b,f.getX(e+0)+y,r.littleEndian),b+=4,i.setUint32(b,f.getX(e+1)+y,r.littleEndian),b+=4,i.setUint32(b,f.getX(e+2)+y,r.littleEndian),b+=4;else for(let e=0,t=s.count;e<t;e+=3)i.setUint8(b,3),b+=1,i.setUint32(b,y+e,r.littleEndian),b+=4,i.setUint32(b,y+e+1,r.littleEndian),b+=4,i.setUint32(b,y+e+2,r.littleEndian),b+=4}y+=s.count}),m=i.buffer}else{let e=0,t="",r="";n(function(s,n){let i=n.getAttribute("position"),c=n.getAttribute("normal"),f=n.getAttribute("uv"),m=n.getAttribute("color"),x=n.getIndex();g.getNormalMatrix(s.matrixWorld);for(let e=0,r=i.count;e<r;e++){d.fromBufferAttribute(i,e),d.applyMatrix4(s.matrixWorld);let r=d.x+" "+d.y+" "+d.z;!0===o&&(null!=c?(d.fromBufferAttribute(c,e),d.applyMatrix3(g).normalize(),r+=" "+d.x+" "+d.y+" "+d.z):r+=" 0 0 0"),!0===h&&(null!=f?r+=" "+f.getX(e)+" "+f.getY(e):r+=" 0 0"),!0===l&&(null!=m?(p.fromBufferAttribute(m,e).convertLinearToSRGB(),r+=" "+Math.floor(255*p.r)+" "+Math.floor(255*p.g)+" "+Math.floor(255*p.b)):r+=" 255 255 255"),t+=r+"\n"}if(!0===a){if(null!==x)for(let t=0,s=x.count;t<s;t+=3)r+="3 ".concat(x.getX(t+0)+e)+" ".concat(x.getX(t+1)+e)+" ".concat(x.getX(t+2)+e,"\n");else for(let t=0,s=i.count;t<s;t+=3)r+="3 ".concat(e+t," ").concat(e+t+1," ").concat(e+t+2,"\n");u+=x?x.count/3:i.count/3}e+=i.count}),m="".concat(f).concat(t).concat(a?"".concat(r,"\n"):"\n")}return"function"==typeof t&&requestAnimationFrame(()=>t(m)),m}}},3946:function(e,t,r){r.d(t,{r:function(){return n}});var s=r(1448);class n{parse(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(r=Object.assign({binary:!1},r)).binary,i=[],a=0;e.traverse(function(e){if(e.isMesh){let t=e.geometry,r=t.index,s=t.getAttribute("position");a+=null!==r?r.count/3:s.count/3,i.push({object3d:e,geometry:t})}});let o=80;!0===n?((t=new DataView(new ArrayBuffer(2*a+48*a+80+4))).setUint32(o,a,!0),o+=4):t="solid exported\n";let l=new s.Pa4,h=new s.Pa4,c=new s.Pa4,u=new s.Pa4,p=new s.Pa4,f=new s.Pa4;for(let e=0,t=i.length;e<t;e++){let t=i[e].object3d,r=i[e].geometry,s=r.index,n=r.getAttribute("position");if(null!==s)for(let e=0;e<s.count;e+=3)d(s.getX(e+0),s.getX(e+1),s.getX(e+2),n,t);else for(let e=0;e<n.count;e+=3)d(e+0,e+1,e+2,n,t)}return!1===n&&(t+="endsolid exported\n"),t;function d(e,r,s,i,a){l.fromBufferAttribute(i,e),h.fromBufferAttribute(i,r),c.fromBufferAttribute(i,s),!0===a.isSkinnedMesh&&(a.applyBoneTransform(e,l),a.applyBoneTransform(r,h),a.applyBoneTransform(s,c)),l.applyMatrix4(a.matrixWorld),h.applyMatrix4(a.matrixWorld),c.applyMatrix4(a.matrixWorld),u.subVectors(c,h),p.subVectors(l,h),u.cross(p).normalize(),f.copy(u).normalize(),!0===n?(t.setFloat32(o,f.x,!0),o+=4,t.setFloat32(o,f.y,!0),o+=4,t.setFloat32(o,f.z,!0),o+=4):t+="	facet normal "+f.x+" "+f.y+" "+f.z+"\n		outer loop\n",g(l),g(h),g(c),!0===n?(t.setUint16(o,0,!0),o+=2):t+="		endloop\n	endfacet\n"}function g(e){!0===n?(t.setFloat32(o,e.x,!0),o+=4,t.setFloat32(o,e.y,!0),o+=4,t.setFloat32(o,e.z,!0),o+=4):t+="			vertex "+e.x+" "+e.y+" "+e.z+"\n"}}}},2046:function(e,t,r){r.d(t,{E:function(){return i}});var s=r(1448);function n(e,t){if(t===s.WwZ)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==s.z$h&&t!==s.UlW)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],s=e.getAttribute("position");if(void 0===s)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<s.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let n=r.count-2,i=[];if(t===s.z$h)for(let e=1;e<=n;e++)i.push(r.getX(0)),i.push(r.getX(e)),i.push(r.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(i.push(r.getX(e)),i.push(r.getX(e+1)),i.push(r.getX(e+2))):(i.push(r.getX(e+2)),i.push(r.getX(e+1)),i.push(r.getX(e)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=e.clone();return a.setIndex(i),a.clearGroups(),a}}class i extends s.aNw{load(e,t,r,n){let i;let a=this;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){let t=s.Zp0.extractUrlBase(e);i=s.Zp0.resolveURL(t,this.path)}else i=s.Zp0.extractUrlBase(e);this.manager.itemStart(e);let o=function(t){n?n(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},l=new s.hH6(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(r){try{a.parse(r,i,function(r){t(r),a.manager.itemEnd(e)},o)}catch(e){o(e)}},r,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,s){let n;let i={},a={},l=new TextDecoder;if("string"==typeof e)n=JSON.parse(e);else if(e instanceof ArrayBuffer){if(l.decode(new Uint8Array(e,0,4))===_){try{i[o.KHR_BINARY_GLTF]=new v(e)}catch(e){s&&s(e);return}n=JSON.parse(i[o.KHR_BINARY_GLTF].content)}else n=JSON.parse(l.decode(e))}else n=e;if(void 0===n.asset||n.asset.version[0]<2){s&&s(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let c=new X(n,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](c);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[t.name]=t,i[t.name]=!0}if(n.extensionsUsed)for(let e=0;e<n.extensionsUsed.length;++e){let t=n.extensionsUsed[e],r=n.extensionsRequired||[];switch(t){case o.KHR_MATERIALS_UNLIT:i[t]=new h;break;case o.KHR_DRACO_MESH_COMPRESSION:i[t]=new M(n,this.dracoLoader);break;case o.KHR_TEXTURE_TRANSFORM:i[t]=new S;break;case o.KHR_MESH_QUANTIZATION:i[t]=new I;break;default:r.indexOf(t)>=0&&void 0===a[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}c.setExtensions(i),c.setPlugins(a),c.parse(r,s)}parseAsync(e,t){let r=this;return new Promise(function(s,n){r.parse(e,t,s,n)})}constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new u(e)}),this.register(function(e){return new w(e)}),this.register(function(e){return new A(e)}),this.register(function(e){return new T(e)}),this.register(function(e){return new f(e)}),this.register(function(e){return new d(e)}),this.register(function(e){return new g(e)}),this.register(function(e){return new m(e)}),this.register(function(e){return new c(e)}),this.register(function(e){return new x(e)}),this.register(function(e){return new p(e)}),this.register(function(e){return new y(e)}),this.register(function(e){return new b(e)}),this.register(function(e){return new l(e)}),this.register(function(e){return new k(e)}),this.register(function(e){return new E(e)})}}function a(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let o={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class l{_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,s=t.length;r<s;r++){let s=t[r];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){let t;let r=this.parser,n="light:"+e,i=r.cache.get(n);if(i)return i;let a=r.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],l=new s.Ilk(16777215);void 0!==o.color&&l.setRGB(o.color[0],o.color[1],o.color[2],s.GUF);let h=void 0!==o.range?o.range:0;switch(o.type){case"directional":(t=new s.Ox3(l)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new s.cek(l)).distance=h;break;case"spot":(t=new s.PMe(l)).distance=h,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,t.angle=o.spot.outerConeAngle,t.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return t.position.set(0,0,0),t.decay=2,$(t,o),void 0!==o.intensity&&(t.intensity=o.intensity),t.name=r.createUniqueName(o.name||"light_"+e),i=Promise.resolve(t),r.cache.add(n,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,r=this.parser,s=r.json.nodes[e],n=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then(function(e){return r._getNodeRef(t.cache,n,e)})}constructor(e){this.parser=e,this.name=o.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}}class h{getMaterialType(){return s.vBJ}extendParams(e,t,r){let n=[];e.color=new s.Ilk(1,1,1),e.opacity=1;let i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){let t=i.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],s.GUF),e.opacity=t[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture,s.KI_))}return Promise.all(n)}constructor(){this.name=o.KHR_MATERIALS_UNLIT}}class c{extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_EMISSIVE_STRENGTH}}class u{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){let e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new s.FM8(e,e)}return Promise.all(i)}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_CLEARCOAT}}class p{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],i=s.extensions[this.name];return void 0!==i.iridescenceFactor&&(t.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&n.push(r.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(t.iridescenceIOR=i.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&n.push(r.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(n)}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_IRIDESCENCE}}class f{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[];t.sheenColor=new s.Ilk(0,0,0),t.sheenRoughness=0,t.sheen=1;let a=n.extensions[this.name];if(void 0!==a.sheenColorFactor){let e=a.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],s.GUF)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,s.KI_)),void 0!==a.sheenRoughnessTexture&&i.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_SHEEN}}class d{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],i=s.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&n.push(r.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(n)}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_TRANSMISSION}}class g{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;let o=a.attenuationColor||[1,1,1];return t.attenuationColor=new s.Ilk().setRGB(o[0],o[1],o[2],s.GUF),Promise.all(i)}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_VOLUME}}class m{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_IOR}}class x{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));let o=a.specularColorFactor||[1,1,1];return t.specularColor=new s.Ilk().setRGB(o[0],o[1],o[2],s.GUF),void 0!==a.specularColorTexture&&i.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,s.KI_)),Promise.all(i)}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_SPECULAR}}class b{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],i=s.extensions[this.name];return t.bumpScale=void 0!==i.bumpFactor?i.bumpFactor:1,void 0!==i.bumpTexture&&n.push(r.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(n)}constructor(e){this.parser=e,this.name=o.EXT_MATERIALS_BUMP}}class y{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],i=s.extensions[this.name];return void 0!==i.anisotropyStrength&&(t.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(t.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&n.push(r.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(n)}constructor(e){this.parser=e,this.name=o.KHR_MATERIALS_ANISOTROPY}}class w{loadTexture(e){let t=this.parser,r=t.json,s=r.textures[e];if(!s.extensions||!s.extensions[this.name])return null;let n=s.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return t.loadTextureImage(e,n.source,i)}constructor(e){this.parser=e,this.name=o.KHR_TEXTURE_BASISU}}class A{loadTexture(e){let t=this.name,r=this.parser,s=r.json,n=s.textures[e];if(!n.extensions||!n.extensions[t])return null;let i=n.extensions[t],a=s.images[i.source],o=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(n){if(n)return r.loadTextureImage(e,i.source,o);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}constructor(e){this.parser=e,this.name=o.EXT_TEXTURE_WEBP,this.isSupported=null}}class T{loadTexture(e){let t=this.name,r=this.parser,s=r.json,n=s.textures[e];if(!n.extensions||!n.extensions[t])return null;let i=n.extensions[t],a=s.images[i.source],o=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(n){if(n)return r.loadTextureImage(e,i.source,o);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}constructor(e){this.parser=e,this.name=o.EXT_TEXTURE_AVIF,this.isSupported=null}}class k{loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],s=this.parser.getDependency("buffer",e.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return s.then(function(t){let r=e.byteOffset||0,s=e.byteLength||0,i=e.count,a=e.byteStride,o=new Uint8Array(t,r,s);return n.decodeGltfBufferAsync?n.decodeGltfBufferAsync(i,a,o,e.mode,e.filter).then(function(e){return e.buffer}):n.ready.then(function(){let t=new ArrayBuffer(i*a);return n.decodeGltfBuffer(new Uint8Array(t),i,a,o,e.mode,e.filter),t})})}}constructor(e){this.name=o.EXT_MESHOPT_COMPRESSION,this.parser=e}}class E{createNodeMesh(e){let t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;for(let e of t.meshes[r.mesh].primitives)if(e.mode!==O.TRIANGLES&&e.mode!==O.TRIANGLE_STRIP&&e.mode!==O.TRIANGLE_FAN&&void 0!==e.mode)return null;let n=r.extensions[this.name].attributes,i=[],a={};for(let e in n)i.push(this.parser.getDependency("accessor",n[e]).then(t=>(a[e]=t,a[e])));return i.length<1?null:(i.push(this.parser.createNodeMesh(e)),Promise.all(i).then(e=>{let t=e.pop(),r=t.isGroup?t.children:[t],n=e[0].count,i=[];for(let e of r){let t=new s.yGw,r=new s.Pa4,o=new s._fP,l=new s.Pa4(1,1,1),h=new s.SPe(e.geometry,e.material,n);for(let e=0;e<n;e++)a.TRANSLATION&&r.fromBufferAttribute(a.TRANSLATION,e),a.ROTATION&&o.fromBufferAttribute(a.ROTATION,e),a.SCALE&&l.fromBufferAttribute(a.SCALE,e),h.setMatrixAt(e,t.compose(r,o,l));for(let t in a)if("_COLOR_0"===t){let e=a[t];h.instanceColor=new s.lb7(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,a[t]);s.Tme.prototype.copy.call(h,e),this.parser.assignFinalMaterial(h),i.push(h)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]}))}constructor(e){this.name=o.EXT_MESH_GPU_INSTANCING,this.parser=e}}let _="glTF",R={JSON:1313821514,BIN:5130562};class v{constructor(e){this.name=o.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==_)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let s=this.header.length-12,n=new DataView(e,12),i=0;for(;i<s;){let t=n.getUint32(i,!0);i+=4;let s=n.getUint32(i,!0);if(i+=4,s===R.JSON){let s=new Uint8Array(e,12+i,t);this.content=r.decode(s)}else if(s===R.BIN){let r=12+i;this.body=e.slice(r,r+t)}i+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class M{decodePrimitive(e,t){let r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},l={},h={};for(let e in a)o[D[e]||e.toLowerCase()]=a[e];for(let t in e.attributes){let s=D[t]||t.toLowerCase();if(void 0!==a[t]){let n=r.accessors[e.attributes[t]],i=C[n.componentType];h[s]=i.name,l[s]=!0===n.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t,r){n.decodeDracoFile(e,function(e){for(let t in e.attributes){let r=e.attributes[t],s=l[t];void 0!==s&&(r.normalized=s)}t(e)},o,h,s.GUF,r)})})}constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=o.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}}class S{extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}constructor(){this.name=o.KHR_TEXTURE_TRANSFORM}}class I{constructor(){this.name=o.KHR_MESH_QUANTIZATION}}class L extends s._C8{copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,s=this.valueSize,n=e*s*3+s;for(let e=0;e!==s;e++)t[e]=r[n+e];return t}interpolate_(e,t,r,s){let n=this.resultBuffer,i=this.sampleValues,a=this.valueSize,o=2*a,l=3*a,h=s-t,c=(r-t)/h,u=c*c,p=u*c,f=e*l,d=f-l,g=-2*p+3*u,m=p-u,x=1-g,b=m-u+c;for(let e=0;e!==a;e++){let t=i[d+e+a],r=i[d+e+o]*h,s=i[f+e+a],l=i[f+e]*h;n[e]=x*t+b*r+g*s+m*l}return n}constructor(e,t,r,s){super(e,t,r,s)}}let U=new s._fP;class N extends L{interpolate_(e,t,r,s){let n=super.interpolate_(e,t,r,s);return U.fromArray(n).normalize().toArray(n),n}}let O={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},C={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},F={9728:s.TyD,9729:s.wem,9984:s.YLQ,9985:s.qyh,9986:s.aH4,9987:s.D1R},P={33071:s.uWy,33648:s.OoA,10497:s.rpg},B={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},D={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},z={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},H={CUBICSPLINE:void 0,LINEAR:s.NMF,STEP:s.Syv},j={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function G(e,t,r){for(let s in r.extensions)void 0===e[s]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[s]=r.extensions[s])}function $(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function V(e){let t="",r=Object.keys(e).sort();for(let s=0,n=r.length;s<n;s++)t+=r[s]+":"+e[r[s]]+";";return t}function K(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let W=new s.yGw;class X{setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,s=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){let i={scene:t[0][s.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:s.asset,parser:r,userData:{}};return G(n,i,s),$(i,s),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(i)})).then(function(){e(i)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){let s=t[r].joints;for(let t=0,r=s.length;t<r;t++)e[s[t]].isBone=!0}for(let t=0,s=e.length;t<s;t++){let s=e[t];void 0!==s.mesh&&(this._addNodeRef(this.meshCache,s.mesh),void 0!==s.skin&&(r[s.mesh].isSkinnedMesh=!0)),void 0!==s.camera&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let s=r.clone(),n=(e,t)=>{let r=this.associations.get(e);for(let[s,i]of(null!=r&&this.associations.set(t,r),e.children.entries()))n(i,t.children[s])};return n(r,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let s=e(t[r]);if(s)return s}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let s=0;s<t.length;s++){let n=e(t[s]);n&&r.push(n)}return r}getDependency(e,t){let r=e+":"+t,s=this.cache.get(r);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":s=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(!(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(r,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,s){return r.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[o.KHR_BINARY_GLTF].body);let n=this.options;return new Promise(function(e,i){r.load(s.Zp0.resolveURL(t.uri,n.path),e,void 0,function(){i(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let r=t.byteLength||0,s=t.byteOffset||0;return e.slice(s,s+r)})}loadAccessor(e){let t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse){let e=B[n.type],t=C[n.componentType],r=!0===n.normalized,i=new t(n.count*e);return Promise.resolve(new s.TlE(i,e,r))}let i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){let i,a;let o=e[0],l=B[n.type],h=C[n.componentType],c=h.BYTES_PER_ELEMENT,u=c*l,p=n.byteOffset||0,f=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,d=!0===n.normalized;if(f&&f!==u){let e=Math.floor(p/f),r="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count,u=t.cache.get(r);u||(i=new h(o,e*f,n.count*f/c),u=new s.vpT(i,f/c),t.cache.add(r,u)),a=new s.kB5(u,l,p%f/c,d)}else i=null===o?new h(n.count*l):new h(o,p,n.count*l),a=new s.TlE(i,l,d);if(void 0!==n.sparse){let t=B.SCALAR,r=C[n.sparse.indices.componentType],i=n.sparse.indices.byteOffset||0,c=n.sparse.values.byteOffset||0,u=new r(e[1],i,n.sparse.count*t),p=new h(e[2],c,n.sparse.count*l);null!==o&&(a=new s.TlE(a.array.slice(),a.itemSize,a.normalized));for(let e=0,t=u.length;e<t;e++){let t=u[e];if(a.setX(t,p[e*l]),l>=2&&a.setY(t,p[e*l+1]),l>=3&&a.setZ(t,p[e*l+2]),l>=4&&a.setW(t,p[e*l+3]),l>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a})}loadTexture(e){let t=this.json,r=this.options,s=t.textures[e].source,n=t.images[s],i=this.textureLoader;if(n.uri){let e=r.manager.getHandler(n.uri);null!==e&&(i=e)}return this.loadTextureImage(e,s,i)}loadTextureImage(e,t,r){let n=this,i=this.json,a=i.textures[e],o=i.images[t],l=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];let h=this.loadImageSource(t,r).then(function(t){t.flipY=!1,t.name=a.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);let r=(i.samplers||{})[a.sampler]||{};return t.magFilter=F[r.magFilter]||s.wem,t.minFilter=F[r.minFilter]||s.D1R,t.wrapS=P[r.wrapS]||s.rpg,t.wrapT=P[r.wrapT]||s.rpg,n.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[l]=h,h}loadImageSource(e,t){let r=this.json,n=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let i=r.images[e],a=self.URL||self.webkitURL,o=i.uri||"",l=!1;if(void 0!==i.bufferView)o=this.getDependency("bufferView",i.bufferView).then(function(e){l=!0;let t=new Blob([e],{type:i.mimeType});return o=a.createObjectURL(t)});else if(void 0===i.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let h=Promise.resolve(o).then(function(e){return new Promise(function(r,i){let a=r;!0===t.isImageBitmapLoader&&(a=function(e){let t=new s.xEZ(e);t.needsUpdate=!0,r(t)}),t.load(s.Zp0.resolveURL(e,n.path),a,void 0,i)})}).then(function(e){var t;return!0===l&&a.revokeObjectURL(o),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=h,h}assignTexture(e,t,r,s){let n=this;return this.getDependency("texture",r.index).then(function(i){if(!i)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((i=i.clone()).channel=r.texCoord),n.extensions[o.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[o.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=n.associations.get(i);i=n.extensions[o.KHR_TEXTURE_TRANSFORM].extendTexture(i,e),n.associations.set(i,t)}}return void 0!==s&&(i.colorSpace=s),e[t]=i,i})}assignFinalMaterial(e){let t=e.geometry,r=e.material,n=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new s.UY4,s.F5T.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new s.nls,s.F5T.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(n||i||a){let e="ClonedMaterial:"+r.uuid+":";n&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),i&&(t.vertexColors=!0),a&&(t.flatShading=!0),n&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return s.Wid}loadMaterial(e){let t;let r=this,n=this.json,i=this.extensions,a=n.materials[e],l={},h=a.extensions||{},c=[];if(h[o.KHR_MATERIALS_UNLIT]){let e=i[o.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),c.push(e.extendParams(l,a,r))}else{let n=a.pbrMetallicRoughness||{};if(l.color=new s.Ilk(1,1,1),l.opacity=1,Array.isArray(n.baseColorFactor)){let e=n.baseColorFactor;l.color.setRGB(e[0],e[1],e[2],s.GUF),l.opacity=e[3]}void 0!==n.baseColorTexture&&c.push(r.assignTexture(l,"map",n.baseColorTexture,s.KI_)),l.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,l.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(c.push(r.assignTexture(l,"metalnessMap",n.metallicRoughnessTexture)),c.push(r.assignTexture(l,"roughnessMap",n.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,l)})))}!0===a.doubleSided&&(l.side=s.ehD);let u=a.alphaMode||j.OPAQUE;if(u===j.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,u===j.MASK&&(l.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==s.vBJ&&(c.push(r.assignTexture(l,"normalMap",a.normalTexture)),l.normalScale=new s.FM8(1,1),void 0!==a.normalTexture.scale)){let e=a.normalTexture.scale;l.normalScale.set(e,e)}if(void 0!==a.occlusionTexture&&t!==s.vBJ&&(c.push(r.assignTexture(l,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(l.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==s.vBJ){let e=a.emissiveFactor;l.emissive=new s.Ilk().setRGB(e[0],e[1],e[2],s.GUF)}return void 0!==a.emissiveTexture&&t!==s.vBJ&&c.push(r.assignTexture(l,"emissiveMap",a.emissiveTexture,s.KI_)),Promise.all(c).then(function(){let s=new t(l);return a.name&&(s.name=a.name),$(s,a),r.associations.set(s,{materials:e}),a.extensions&&G(i,s,a),s})}createUniqueName(e){let t=s.iUV.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,r=this.extensions,n=this.primitiveCache,i=[];for(let a=0,l=e.length;a<l;a++){let l=e[a],h=function(e){let t;let r=e.extensions&&e.extensions[o.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+V(r.attributes):e.indices+":"+V(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,s=e.targets.length;r<s;r++)t+=":"+V(e.targets[r]);return t}(l),c=n[h];if(c)i.push(c.promise);else{let e;e=l.extensions&&l.extensions[o.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[o.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return q(r,e,t)})}(l):q(new s.u9r,l,t),n[h]={primitive:l,promise:e},i.push(e)}}return Promise.all(i)}loadMesh(e){let t=this,r=this.json,i=this.extensions,a=r.meshes[e],o=a.primitives,l=[];for(let e=0,t=o.length;e<t;e++){var h;let t=void 0===o[e].material?(void 0===(h=this.cache).DefaultMaterial&&(h.DefaultMaterial=new s.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:s.Wl3})),h.DefaultMaterial):this.getDependency("material",o[e].material);l.push(t)}return l.push(t.loadGeometries(o)),Promise.all(l).then(function(r){let l=r.slice(0,r.length-1),h=r[r.length-1],c=[];for(let r=0,u=h.length;r<u;r++){let u;let p=h[r],f=o[r],d=l[r];if(f.mode===O.TRIANGLES||f.mode===O.TRIANGLE_STRIP||f.mode===O.TRIANGLE_FAN||void 0===f.mode)!0===(u=!0===a.isSkinnedMesh?new s.TUv(p,d):new s.Kj0(p,d)).isSkinnedMesh&&u.normalizeSkinWeights(),f.mode===O.TRIANGLE_STRIP?u.geometry=n(u.geometry,s.UlW):f.mode===O.TRIANGLE_FAN&&(u.geometry=n(u.geometry,s.z$h));else if(f.mode===O.LINES)u=new s.ejS(p,d);else if(f.mode===O.LINE_STRIP)u=new s.x12(p,d);else if(f.mode===O.LINE_LOOP)u=new s.blk(p,d);else if(f.mode===O.POINTS)u=new s.woe(p,d);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);Object.keys(u.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,s=t.weights.length;r<s;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){let r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,s=r.length;t<s;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(u,a),u.name=t.createUniqueName(a.name||"mesh_"+e),$(u,a),f.extensions&&G(i,u,f),t.assignFinalMaterial(u),c.push(u)}for(let r=0,s=c.length;r<s;r++)t.associations.set(c[r],{meshes:e,primitives:r});if(1===c.length)return a.extensions&&G(i,c[0],a),c[0];let u=new s.ZAu;a.extensions&&G(i,u,a),t.associations.set(u,{meshes:e});for(let e=0,t=c.length;e<t;e++)u.add(c[e]);return u})}loadCamera(e){let t;let r=this.json.cameras[e],n=r[r.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?t=new s.cPb(s.M8C.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new s.iKG(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),$(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r=[];for(let e=0,s=t.joints.length;e<s;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),n=[],i=[];for(let a=0,o=e.length;a<o;a++){let o=e[a];if(o){n.push(o);let e=new s.yGw;null!==r&&e.fromArray(r.array,16*a),i.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}return new s.OdW(n,i)})}loadAnimation(e){let t=this.json,r=this,n=t.animations[e],i=n.name?n.name:"animation_"+e,a=[],o=[],l=[],h=[],c=[];for(let e=0,t=n.channels.length;e<t;e++){let t=n.channels[e],r=n.samplers[t.sampler],s=t.target,i=s.node,u=void 0!==n.parameters?n.parameters[r.input]:r.input,p=void 0!==n.parameters?n.parameters[r.output]:r.output;void 0!==s.node&&(a.push(this.getDependency("node",i)),o.push(this.getDependency("accessor",u)),l.push(this.getDependency("accessor",p)),h.push(r),c.push(s))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l),Promise.all(h),Promise.all(c)]).then(function(e){let t=e[0],n=e[1],a=e[2],o=e[3],l=e[4],h=[];for(let e=0,s=t.length;e<s;e++){let s=t[e],i=n[e],c=a[e],u=o[e],p=l[e];if(void 0===s)continue;s.updateMatrix&&s.updateMatrix();let f=r._createAnimationTracks(s,i,c,u,p);if(f)for(let e=0;e<f.length;e++)h.push(f[e])}return new s.m7l(i,void 0,h)})}createNodeMesh(e){let t=this.json,r=this,s=t.nodes[e];return void 0===s.mesh?null:r.getDependency("mesh",s.mesh).then(function(e){let t=r._getNodeRef(r.meshCache,s.mesh,e);return void 0!==s.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,r=s.weights.length;t<r;t++)e.morphTargetInfluences[t]=s.weights[t]}),t})}loadNode(e){let t=this.json.nodes[e],r=this._loadNodeShallow(e),s=[],n=t.children||[];for(let e=0,t=n.length;e<t;e++)s.push(this.getDependency("node",n[e]));let i=void 0===t.skin?Promise.resolve(null):this.getDependency("skin",t.skin);return Promise.all([r,Promise.all(s),i]).then(function(e){let t=e[0],r=e[1],s=e[2];null!==s&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(s,W)});for(let e=0,s=r.length;e<s;e++)t.add(r[e]);return t})}_loadNodeShallow(e){let t=this.json,r=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let i=t.nodes[e],a=i.name?n.createUniqueName(i.name):"",o=[],l=n._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return l&&o.push(l),void 0!==i.camera&&o.push(n.getDependency("camera",i.camera).then(function(e){return n._getNodeRef(n.cameraCache,i.camera,e)})),n._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){o.push(e)}),this.nodeCache[e]=Promise.all(o).then(function(t){let o;if((o=!0===i.isBone?new s.N$j:t.length>1?new s.ZAu:1===t.length?t[0]:new s.Tme)!==t[0])for(let e=0,r=t.length;e<r;e++)o.add(t[e]);if(i.name&&(o.userData.name=i.name,o.name=a),$(o,i),i.extensions&&G(r,o,i),void 0!==i.matrix){let e=new s.yGw;e.fromArray(i.matrix),o.applyMatrix4(e)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return n.associations.has(o)||n.associations.set(o,{}),n.associations.get(o).nodes=e,o}),this.nodeCache[e]}loadScene(e){let t=this.extensions,r=this.json.scenes[e],n=this,i=new s.ZAu;r.name&&(i.name=n.createUniqueName(r.name)),$(i,r),r.extensions&&G(t,i,r);let a=r.nodes||[],o=[];for(let e=0,t=a.length;e<t;e++)o.push(n.getDependency("node",a[e]));return Promise.all(o).then(function(e){for(let t=0,r=e.length;t<r;t++)i.add(e[t]);return n.associations=(e=>{let t=new Map;for(let[e,r]of n.associations)(e instanceof s.F5T||e instanceof s.xEZ)&&t.set(e,r);return e.traverse(e=>{let r=n.associations.get(e);null!=r&&t.set(e,r)}),t})(i),i})}_createAnimationTracks(e,t,r,n,i){let a;let o=[],l=e.name?e.name:e.uuid,h=[];switch(z[i.path]===z.weights?e.traverse(function(e){e.morphTargetInfluences&&h.push(e.name?e.name:e.uuid)}):h.push(l),z[i.path]){case z.weights:a=s.dUE;break;case z.rotation:a=s.iLg;break;case z.position:case z.scale:a=s.yC1;break;default:a=1===r.itemSize?s.dUE:s.yC1}let c=void 0!==n.interpolation?H[n.interpolation]:s.NMF,u=this._getArrayFromAccessor(r);for(let e=0,r=h.length;e<r;e++){let r=new a(h[e]+"."+z[i.path],t.array,u,c);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(r),o.push(r)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=K(t.constructor),r=new Float32Array(t.length);for(let s=0,n=t.length;s<n;s++)r[s]=t[s]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof s.iLg?N:L)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new a,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,n=!1,i=-1;"undefined"!=typeof navigator&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=(n=navigator.userAgent.indexOf("Firefox")>-1)?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||n&&i<98?this.textureLoader=new s.dpR(this.options.manager):this.textureLoader=new s.QRU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new s.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}}function q(e,t,r){let n=t.attributes,i=[];for(let t in n){let s=D[t]||t.toLowerCase();s in e.attributes||i.push(function(t,s){return r.getDependency("accessor",t).then(function(t){e.setAttribute(s,t)})}(n[t],s))}if(void 0!==t.indices&&!e.index){let s=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(s)}return s.epp.workingColorSpace!==s.GUF&&"COLOR_0"in n&&console.warn('THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "'.concat(s.epp.workingColorSpace,'" not supported.')),$(e,t),!function(e,t,r){let n=t.attributes,i=new s.ZzF;if(void 0===n.POSITION)return;{let e=r.json.accessors[n.POSITION],t=e.min,a=e.max;if(void 0!==t&&void 0!==a){if(i.set(new s.Pa4(t[0],t[1],t[2]),new s.Pa4(a[0],a[1],a[2])),e.normalized){let t=K(C[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let a=t.targets;if(void 0!==a){let e=new s.Pa4,t=new s.Pa4;for(let s=0,n=a.length;s<n;s++){let n=a[s];if(void 0!==n.POSITION){let s=r.json.accessors[n.POSITION],i=s.min,a=s.max;if(void 0!==i&&void 0!==a){if(t.setX(Math.max(Math.abs(i[0]),Math.abs(a[0]))),t.setY(Math.max(Math.abs(i[1]),Math.abs(a[1]))),t.setZ(Math.max(Math.abs(i[2]),Math.abs(a[2]))),s.normalized){let e=K(C[s.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;let o=new s.aLr;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=o}(e,t,r),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,r){let s=!1,n=!1,i=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(s=!0),void 0!==r.NORMAL&&(n=!0),void 0!==r.COLOR_0&&(i=!0),s&&n&&i)break}if(!s&&!n&&!i)return Promise.resolve(e);let a=[],o=[],l=[];for(let h=0,c=t.length;h<c;h++){let c=t[h];if(s){let t=void 0!==c.POSITION?r.getDependency("accessor",c.POSITION):e.attributes.position;a.push(t)}if(n){let t=void 0!==c.NORMAL?r.getDependency("accessor",c.NORMAL):e.attributes.normal;o.push(t)}if(i){let t=void 0!==c.COLOR_0?r.getDependency("accessor",c.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l)]).then(function(t){let r=t[0],a=t[1],o=t[2];return s&&(e.morphAttributes.position=r),n&&(e.morphAttributes.normal=a),i&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}},5087:function(e,t,r){r.d(t,{L:function(){return m}});var s=r(1448);let n=/^[og]\s*(.+)?/,i=/^mtllib /,a=/^usemtl /,o=/^usemap /,l=/\s+/,h=new s.Pa4,c=new s.Pa4,u=new s.Pa4,p=new s.Pa4,f=new s.Pa4,d=new s.Ilk;function g(){let e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=!1!==t;return}let r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){let r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);let s={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){let t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(s),s},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){let t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(let e=this.materials.length-1;e>=0;e--)this.materials[e].groupCount<=0&&this.materials.splice(e,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"==typeof r.clone){let e=r.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){let r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseNormalIndex:function(e,t){let r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseUVIndex:function(e,t){let r=parseInt(e,10);return(r>=0?r-1:r+t/2)*2},addVertex:function(e,t,r){let s=this.vertices,n=this.object.geometry.vertices;n.push(s[e+0],s[e+1],s[e+2]),n.push(s[t+0],s[t+1],s[t+2]),n.push(s[r+0],s[r+1],s[r+2])},addVertexPoint:function(e){let t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){let t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){let s=this.normals,n=this.object.geometry.normals;n.push(s[e+0],s[e+1],s[e+2]),n.push(s[t+0],s[t+1],s[t+2]),n.push(s[r+0],s[r+1],s[r+2])},addFaceNormal:function(e,t,r){let s=this.vertices,n=this.object.geometry.normals;h.fromArray(s,e),c.fromArray(s,t),u.fromArray(s,r),f.subVectors(u,c),p.subVectors(h,c),f.cross(p),f.normalize(),n.push(f.x,f.y,f.z),n.push(f.x,f.y,f.z),n.push(f.x,f.y,f.z)},addColor:function(e,t,r){let s=this.colors,n=this.object.geometry.colors;void 0!==s[e]&&n.push(s[e+0],s[e+1],s[e+2]),void 0!==s[t]&&n.push(s[t+0],s[t+1],s[t+2]),void 0!==s[r]&&n.push(s[r+0],s[r+1],s[r+2])},addUV:function(e,t,r){let s=this.uvs,n=this.object.geometry.uvs;n.push(s[e+0],s[e+1]),n.push(s[t+0],s[t+1]),n.push(s[r+0],s[r+1])},addDefaultUV:function(){let e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){let t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,s,n,i,a,o,l){let h=this.vertices.length,c=this.parseVertexIndex(e,h),u=this.parseVertexIndex(t,h),p=this.parseVertexIndex(r,h);if(this.addVertex(c,u,p),this.addColor(c,u,p),void 0!==a&&""!==a){let e=this.normals.length;c=this.parseNormalIndex(a,e),u=this.parseNormalIndex(o,e),p=this.parseNormalIndex(l,e),this.addNormal(c,u,p)}else this.addFaceNormal(c,u,p);if(void 0!==s&&""!==s){let e=this.uvs.length;c=this.parseUVIndex(s,e),u=this.parseUVIndex(n,e),p=this.parseUVIndex(i,e),this.addUV(c,u,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";let t=this.vertices.length;for(let r=0,s=e.length;r<s;r++){let s=this.parseVertexIndex(e[r],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";let r=this.vertices.length,s=this.uvs.length;for(let t=0,s=e.length;t<s;t++)this.addVertexLine(this.parseVertexIndex(e[t],r));for(let e=0,r=t.length;e<r;e++)this.addUVLine(this.parseUVIndex(t[e],s))}};return e.startObject("",!1),e}class m extends s.aNw{load(e,t,r,n){let i=this,a=new s.hH6(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(r){try{t(i.parse(r))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}setMaterials(e){return this.materials=e,this}parse(e){let t=new g;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));let r=e.split("\n"),h=[];for(let e=0,s=r.length;e<s;e++){let s=r[e].trimStart();if(0===s.length)continue;let c=s.charAt(0);if("#"!==c){if("v"===c){let e=s.split(l);switch(e[0]){case"v":t.vertices.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])),e.length>=7?(d.setRGB(parseFloat(e[4]),parseFloat(e[5]),parseFloat(e[6])).convertSRGBToLinear(),t.colors.push(d.r,d.g,d.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]));break;case"vt":t.uvs.push(parseFloat(e[1]),parseFloat(e[2]))}}else if("f"===c){let e=s.slice(1).trim().split(l),r=[];for(let t=0,s=e.length;t<s;t++){let s=e[t];if(s.length>0){let e=s.split("/");r.push(e)}}let n=r[0];for(let e=1,s=r.length-1;e<s;e++){let s=r[e],i=r[e+1];t.addFace(n[0],s[0],i[0],n[1],s[1],i[1],n[2],s[2],i[2])}}else if("l"===c){let e=s.substring(1).trim().split(" "),r=[],n=[];if(-1===s.indexOf("/"))r=e;else for(let t=0,s=e.length;t<s;t++){let s=e[t].split("/");""!==s[0]&&r.push(s[0]),""!==s[1]&&n.push(s[1])}t.addLineGeometry(r,n)}else if("p"===c){let e=s.slice(1).trim().split(" ");t.addPointGeometry(e)}else if(null!==(h=n.exec(s))){let e=(" "+h[0].slice(1).trim()).slice(1);t.startObject(e)}else if(a.test(s))t.object.startMaterial(s.substring(7).trim(),t.materialLibraries);else if(i.test(s))t.materialLibraries.push(s.substring(7).trim());else if(o.test(s))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===c){if((h=s.split(" ")).length>1){let e=h[1].trim().toLowerCase();t.object.smooth="0"!==e&&"off"!==e}else t.object.smooth=!0;let e=t.object.currentMaterial();e&&(e.smooth=t.object.smooth)}else{if("\0"===s)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+s+'"')}}}t.finalize();let c=new s.ZAu;if(c.materialLibraries=[].concat(t.materialLibraries),!0==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let e=0,r=t.objects.length;e<r;e++){let r;let n=t.objects[e],i=n.geometry,a=n.materials,o="Line"===i.type,l="Points"===i.type,h=!1;if(0===i.vertices.length)continue;let u=new s.u9r;u.setAttribute("position",new s.a$l(i.vertices,3)),i.normals.length>0&&u.setAttribute("normal",new s.a$l(i.normals,3)),i.colors.length>0&&(h=!0,u.setAttribute("color",new s.a$l(i.colors,3))),!0===i.hasUVIndices&&u.setAttribute("uv",new s.a$l(i.uvs,2));let p=[];for(let e=0,r=a.length;e<r;e++){let r=a[e],n=r.name+"_"+r.smooth+"_"+h,i=t.materials[n];if(null!==this.materials){if(i=this.materials.create(r.name),!o||!i||i instanceof s.nls){if(l&&i&&!(i instanceof s.UY4)){let e=new s.UY4({size:10,sizeAttenuation:!1});s.F5T.prototype.copy.call(e,i),e.color.copy(i.color),e.map=i.map,i=e}}else{let e=new s.nls;s.F5T.prototype.copy.call(e,i),e.color.copy(i.color),i=e}}void 0===i&&((i=o?new s.nls:l?new s.UY4({size:1,sizeAttenuation:!1}):new s.xoR).name=r.name,i.flatShading=!r.smooth,i.vertexColors=h,t.materials[n]=i),p.push(i)}if(p.length>1){for(let e=0,t=a.length;e<t;e++){let t=a[e];u.addGroup(t.groupStart,t.groupCount,e)}r=o?new s.ejS(u,p):l?new s.woe(u,p):new s.Kj0(u,p)}else r=o?new s.ejS(u,p[0]):l?new s.woe(u,p[0]):new s.Kj0(u,p[0]);r.name=n.name,c.add(r)}else if(t.vertices.length>0){let e=new s.UY4({size:1,sizeAttenuation:!1}),r=new s.u9r;r.setAttribute("position",new s.a$l(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(r.setAttribute("color",new s.a$l(t.colors,3)),e.vertexColors=!0);let n=new s.woe(r,e);c.add(n)}return c}constructor(e){super(e),this.materials=null}}},7213:function(e,t,r){r.d(t,{j:function(){return n}});var s=r(1448);class n extends s.aNw{load(e,t,r,n){let i=this,a=new s.hH6(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(r){try{t(i.parse(r))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t=function(e){if("string"!=typeof e)return e;{let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}}(e);return!function(e){let t=new DataView(e);if(84+50*t.getUint32(80,!0)===t.byteLength)return!0;let r=[115,111,108,105,100];for(let e=0;e<5;e++)if(function(e,t,r){for(let s=0,n=e.length;s<n;s++)if(e[s]!==t.getUint8(r+s))return!1;return!0}(r,t,e))return!1;return!0}(t)?function(e){let t;let r=new s.u9r,n=/solid([\s\S]*?)endsolid/g,i=/facet([\s\S]*?)endfacet/g,a=/solid\s(.+)/,o=0,l=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,h=RegExp("vertex"+l+l+l,"g"),c=RegExp("normal"+l+l+l,"g"),u=[],p=[],f=[],d=new s.Pa4,g=0,m=0,x=0;for(;null!==(t=n.exec(e));){m=x;let e=t[0],s=null!==(t=a.exec(e))?t[1]:"";for(f.push(s);null!==(t=i.exec(e));){let e=0,r=0,s=t[0];for(;null!==(t=c.exec(s));)d.x=parseFloat(t[1]),d.y=parseFloat(t[2]),d.z=parseFloat(t[3]),r++;for(;null!==(t=h.exec(s));)u.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),p.push(d.x,d.y,d.z),e++,x++;1!==r&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+o),3!==e&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+o),o++}let n=m,l=x-m;r.userData.groupNames=f,r.addGroup(n,l,g),g++}return r.setAttribute("position",new s.a$l(u,3)),r.setAttribute("normal",new s.a$l(p,3)),r}("string"!=typeof e?new TextDecoder().decode(e):e):function(e){let t,r,n,i;let a=new DataView(e),o=a.getUint32(80,!0),l,h,c,u=!1,p;for(let e=0;e<70;e++)1129270351==a.getUint32(e,!1)&&82==a.getUint8(e+4)&&61==a.getUint8(e+5)&&(u=!0,p=new Float32Array(9*o),t=a.getUint8(e+6)/255,r=a.getUint8(e+7)/255,n=a.getUint8(e+8)/255,i=a.getUint8(e+9)/255);let f=new s.u9r,d=new Float32Array(9*o),g=new Float32Array(9*o),m=new s.Ilk;for(let e=0;e<o;e++){let s=84+50*e,i=a.getFloat32(s,!0),o=a.getFloat32(s+4,!0),f=a.getFloat32(s+8,!0);if(u){let e=a.getUint16(s+48,!0);(32768&e)==0?(l=(31&e)/31,h=(e>>5&31)/31,c=(e>>10&31)/31):(l=t,h=r,c=n)}for(let t=1;t<=3;t++){let r=s+12*t,n=9*e+(t-1)*3;d[n]=a.getFloat32(r,!0),d[n+1]=a.getFloat32(r+4,!0),d[n+2]=a.getFloat32(r+8,!0),g[n]=i,g[n+1]=o,g[n+2]=f,u&&(m.set(l,h,c).convertSRGBToLinear(),p[n]=m.r,p[n+1]=m.g,p[n+2]=m.b)}}return f.setAttribute("position",new s.TlE(d,3)),f.setAttribute("normal",new s.TlE(g,3)),u&&(f.setAttribute("color",new s.TlE(p,3)),f.hasColors=!0,f.alpha=i),f}(t)}constructor(e){super(e)}}}}]);