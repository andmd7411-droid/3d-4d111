(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[71],{4798:function(e,t,l){Promise.resolve().then(l.bind(l,5673))},5673:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return v}});var a=l(7437),n=l(2265),r=l(7648),o=l(1448),s=l(2691);function i(e){let{meshData:t,wireframe:l=!1,autoRotate:r=!1,lightIntensity:i=1}=e,c=(0,n.useRef)(null),d=(0,n.useRef)(null),h=(0,n.useRef)(null),u=(0,n.useRef)(null),p=(0,n.useRef)([]),x=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(!c.current)return;let e=new o.xsS;e.background=new o.Ilk(657930),d.current=e;let t=new o.cPb(75,c.current.clientWidth/c.current.clientHeight,.1,1e3);t.position.z=100;let l=new o.CP7({antialias:!0});l.setSize(c.current.clientWidth,c.current.clientHeight),l.setPixelRatio(window.devicePixelRatio),c.current.appendChild(l.domElement),h.current=l;let a=new s.z(t,l.domElement);a.enableDamping=!0,a.dampingFactor=.05,a.autoRotate=r,a.autoRotateSpeed=2,x.current=a;let n=new o.Mig(16777215,.6*i);e.add(n);let u=new o.Ox3(26367,.8*i);u.position.set(5,5,5),e.add(u);let m=new o.Ox3(10040319,.6*i);m.position.set(-5,-5,-5),e.add(m),p.current=[n,u,m];let g=new o.VLJ(200,20,26367,3355443);e.add(g);let f=()=>{requestAnimationFrame(f),a.update(),l.render(e,t)};f();let b=()=>{c.current&&(t.aspect=c.current.clientWidth/c.current.clientHeight,t.updateProjectionMatrix(),l.setSize(c.current.clientWidth,c.current.clientHeight))};return window.addEventListener("resize",b),()=>{var e;window.removeEventListener("resize",b),l.dispose(),null===(e=c.current)||void 0===e||e.removeChild(l.domElement)}},[]),(0,n.useEffect)(()=>{var e;if(!d.current||!t)return;u.current&&(d.current.remove(u.current),u.current.geometry.dispose(),Array.isArray(u.current.material)?u.current.material.forEach(e=>e.dispose()):u.current.material.dispose());let a=new o.u9r;a.setAttribute("position",new o.TlE(t.vertices,3)),a.setIndex(new o.TlE(t.indices,1)),t.normals?a.setAttribute("normal",new o.TlE(t.normals,3)):a.computeVertexNormals();let n=new o.Wid({color:6724095,metalness:.3,roughness:.4,flatShading:!1,wireframe:l}),r=new o.Kj0(a,n);u.current=r,d.current.add(r),a.computeBoundingBox();let s=new o.Pa4;null===(e=a.boundingBox)||void 0===e||e.getCenter(s),r.position.sub(s)},[t,l]),(0,n.useEffect)(()=>{x.current&&(x.current.autoRotate=r)},[r]),(0,n.useEffect)(()=>{p.current.length>0&&(p.current[0].intensity=.6*i,p.current[1].intensity=.8*i,p.current[2].intensity=.6*i)},[i]),(0,a.jsx)("div",{ref:c,className:"w-full h-full"})}function c(e){let{meshData:t,onMeshUpdate:l}=e,[r,o]=(0,n.useState)(!1),s=(0,n.useCallback)(e=>{t&&!r&&(o(!0),setTimeout(()=>{try{let a=new Float32Array(t.vertices),n=new Uint32Array(t.indices);switch(e){case"rotateX":d(a,Math.PI/6,"x");break;case"rotateY":d(a,Math.PI/6,"y");break;case"rotateZ":d(a,Math.PI/6,"z");break;case"scaleUp":h(a,1.15);break;case"scaleDown":h(a,.85);break;case"extrudeUp":u(a,1.25);break;case"extrudeDown":u(a,.75)}let r=function(e,t){let l=new Float32Array(e.length);for(let e=0;e<l.length;e++)l[e]=0;for(let a=0;a<t.length;a+=3){let n=3*t[a],r=3*t[a+1],o=3*t[a+2],s=e[n],i=e[n+1],c=e[n+2],d=e[r],h=e[r+1],u=e[r+2],p=e[o],x=e[o+1],m=e[o+2],g=d-s,f=h-i,b=u-c,v=p-s,w=x-i,j=m-c,y=f*j-b*w,N=b*v-g*j,D=g*w-f*v;l[n]+=y,l[n+1]+=N,l[n+2]+=D,l[r]+=y,l[r+1]+=N,l[r+2]+=D,l[o]+=y,l[o+1]+=N,l[o+2]+=D}for(let e=0;e<l.length;e+=3){let t=Math.sqrt(l[e]*l[e]+l[e+1]*l[e+1]+l[e+2]*l[e+2]);t>0&&(l[e]/=t,l[e+1]/=t,l[e+2]/=t)}return l}(a,n);l({vertices:a,indices:n,normals:r})}catch(e){console.error("Transform error:",e)}finally{o(!1)}},50))},[t,l,r]),i=[{id:"rotateX",label:"Rotate X",icon:"\uD83D\uDD04",color:"bg-blue-500",category:"transform"},{id:"rotateY",label:"Rotate Y",icon:"\uD83D\uDD04",color:"bg-blue-600",category:"transform"},{id:"rotateZ",label:"Rotate Z",icon:"\uD83D\uDD04",color:"bg-blue-700",category:"transform"},{id:"scaleUp",label:"Scale +",icon:"➕",color:"bg-green-500",category:"scale"},{id:"scaleDown",label:"Scale -",icon:"➖",color:"bg-green-600",category:"scale"},{id:"extrudeUp",label:"Extrude +",icon:"⬆️",color:"bg-purple-500",category:"extrude"},{id:"extrudeDown",label:"Extrude -",icon:"⬇️",color:"bg-purple-600",category:"extrude"}];return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white",children:"Transform Tools"}),!t&&(0,a.jsx)("p",{className:"text-white/60 text-xs bg-white/10 p-2 rounded",children:"Upload image first"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-cyan-300 text-xs font-bold",children:"\uD83D\uDD04 Rotate"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-1",children:i.filter(e=>"transform"===e.category).map(e=>(0,a.jsx)("button",{onClick:()=>s(e.id),disabled:!t||r,className:"".concat(e.color," hover:opacity-90 text-white font-bold py-2 px-2 rounded text-xs transition-all disabled:opacity-30 disabled:cursor-not-allowed shadow-lg"),title:e.label,children:e.icon},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-green-300 text-xs font-bold",children:"\uD83D\uDCCF Scale"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-1",children:i.filter(e=>"scale"===e.category).map(e=>(0,a.jsxs)("button",{onClick:()=>s(e.id),disabled:!t||r,className:"".concat(e.color," hover:opacity-90 text-white font-bold py-2 px-2 rounded text-xs transition-all disabled:opacity-30 disabled:cursor-not-allowed shadow-lg"),title:e.label,children:[e.icon," ",e.label]},e.id))})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-purple-300 text-xs font-bold",children:"⬆️ Extrude"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-1",children:i.filter(e=>"extrude"===e.category).map(e=>(0,a.jsxs)("button",{onClick:()=>s(e.id),disabled:!t||r,className:"".concat(e.color," hover:opacity-90 text-white font-bold py-2 px-2 rounded text-xs transition-all disabled:opacity-30 disabled:cursor-not-allowed shadow-lg"),title:e.label,children:[e.icon," ",e.label]},e.id))})]})]}),r&&(0,a.jsx)("div",{className:"text-center text-white/80 text-xs animate-pulse bg-gradient-to-r from-blue-500 to-purple-500 py-2 rounded font-bold",children:"Processing..."}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-500/20 to-purple-500/20 p-2 rounded text-xs text-white/80 border border-white/20",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"\uD83D\uDCA1 Pro Tips:"}),(0,a.jsxs)("ul",{className:"text-[10px] space-y-0.5 ml-3",children:[(0,a.jsx)("li",{children:"• Use Settings panel for quality controls"}),(0,a.jsx)("li",{children:"• All quality tools are in Settings"}),(0,a.jsx)("li",{children:"• These tools are safe and fast"})]})]})]})}function d(e,t,l){let a=Math.cos(t),n=Math.sin(t);for(let t=0;t<e.length;t+=3){let r=e[t],o=e[t+1],s=e[t+2];"x"===l?(e[t+1]=o*a-s*n,e[t+2]=o*n+s*a):"y"===l?(e[t]=r*a+s*n,e[t+2]=-r*n+s*a):"z"===l&&(e[t]=r*a-o*n,e[t+1]=r*n+o*a)}}function h(e,t){for(let l=0;l<e.length;l++)e[l]*=t}function u(e,t){for(let l=1;l<e.length;l+=3)e[l]*=t}var p=l(3145);function x(e){let{onSettingsChange:t}=e,[l,r]=(0,n.useState)({resolution:192,detailLevel:"high",depth:90,baseHeight:12,projection:"plane",smoothness:6,edgeSharpness:2,surfaceDetail:9,noiseReduction:5,contrastBoost:1.5,depthEnhancement:1.6,bilateralFilter:6,laplacianEnhancement:4,multiScaleProcessing:!0,edgePreservation:8,meshOptimization:!0,anisotropicDiffusion:5,unsharpMasking:4,gradientEnhancement:6,adaptiveContrast:!0,invertDepth:!1,adaptiveResolution:!0,highQualityNormals:!0,wireframeMode:!1,autoRotate:!1,lightIntensity:1.8,showGrid:!0}),o=(e,a)=>{let n={...l,[e]:a};"detailLevel"===e&&(n.resolution=({low:64,med:128,high:192,ultra:256,extreme:320})[a]),r(n),t(n)};return(0,a.jsxs)("div",{className:"space-y-2 text-xs overflow-y-auto max-h-full",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-white mb-1 sticky top-0 bg-gradient-to-r from-purple-900 to-blue-900 py-2 rounded z-10",children:"\uD83C\uDFAF Ultimate Quality"}),(0,a.jsxs)("div",{className:"space-y-1 border-b border-white/20 pb-2",children:[(0,a.jsx)("h3",{className:"text-cyan-300 font-bold text-xs",children:"Resolution"}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-1",children:["low","med","high","ultra","extreme"].map(e=>(0,a.jsx)("button",{onClick:()=>o("detailLevel",e),className:"py-1.5 px-1 rounded font-bold text-[10px] transition-all ".concat(l.detailLevel===e?"bg-gradient-to-r from-blue-500 to-purple-500 text-white scale-105 shadow-lg":"bg-white/20 text-white hover:bg-white/30"),children:e.toUpperCase()},e))}),(0,a.jsxs)("p",{className:"text-[10px] text-white/60 text-center bg-white/10 py-0.5 rounded",children:[l.resolution," vertices"]})]}),(0,a.jsxs)("div",{className:"space-y-1 border-b border-white/20 pb-2",children:[(0,a.jsx)("h3",{className:"text-cyan-300 font-bold text-xs",children:"Projection"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-1",children:["plane","cylinder","cookie"].map(e=>(0,a.jsx)("button",{onClick:()=>o("projection",e),className:"py-1.5 px-1 rounded font-bold text-[10px] transition-all ".concat(l.projection===e?"bg-gradient-to-r from-orange-500 to-red-500 text-white scale-105":"bg-white/20 text-white hover:bg-white/30"),children:e.toUpperCase()},e))})]}),(0,a.jsxs)("div",{className:"space-y-1.5 border-b border-white/20 pb-2 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 p-2 rounded",children:[(0,a.jsx)("h3",{className:"text-yellow-300 font-bold text-xs",children:"\uD83D\uDE80 Cutting-Edge"}),(0,a.jsx)(m,{label:"Anisotropic Diffusion",value:l.anisotropicDiffusion,onChange:e=>o("anisotropicDiffusion",e),min:0,max:10,step:1,color:"bg-yellow-500",tooltip:"Advanced edge-preserving smoothing"}),(0,a.jsx)(m,{label:"Unsharp Masking",value:l.unsharpMasking,onChange:e=>o("unsharpMasking",e),min:0,max:10,step:1,color:"bg-orange-500",tooltip:"Professional detail enhancement"}),(0,a.jsx)(m,{label:"Gradient Enhance",value:l.gradientEnhancement,onChange:e=>o("gradientEnhancement",e),min:0,max:10,step:1,color:"bg-red-500",tooltip:"Enhances depth gradients"}),(0,a.jsx)(g,{label:"Adaptive Contrast",value:l.adaptiveContrast,onChange:e=>o("adaptiveContrast",e)})]}),(0,a.jsxs)("div",{className:"space-y-1.5 border-b border-white/20 pb-2",children:[(0,a.jsx)("h3",{className:"text-purple-300 font-bold text-xs",children:"⚡ Industrial"}),(0,a.jsx)(m,{label:"Bilateral Filter",value:l.bilateralFilter,onChange:e=>o("bilateralFilter",e),min:0,max:10,step:1,color:"bg-cyan-500"}),(0,a.jsx)(m,{label:"Laplacian Enhance",value:l.laplacianEnhancement,onChange:e=>o("laplacianEnhancement",e),min:0,max:10,step:1,color:"bg-purple-500"}),(0,a.jsx)(m,{label:"Edge Preservation",value:l.edgePreservation,onChange:e=>o("edgePreservation",e),min:0,max:10,step:1,color:"bg-pink-500"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[(0,a.jsx)(g,{label:"Multi-Scale",value:l.multiScaleProcessing,onChange:e=>o("multiScaleProcessing",e)}),(0,a.jsx)(g,{label:"Mesh Opt",value:l.meshOptimization,onChange:e=>o("meshOptimization",e)})]})]}),(0,a.jsxs)("div",{className:"space-y-1.5 border-b border-white/20 pb-2",children:[(0,a.jsx)("h3",{className:"text-green-300 font-bold text-xs",children:"✨ Quality"}),(0,a.jsx)(m,{label:"Smoothness",value:l.smoothness,onChange:e=>o("smoothness",e),min:0,max:10,step:1,color:"bg-blue-500"}),(0,a.jsx)(m,{label:"Edge Sharpness",value:l.edgeSharpness,onChange:e=>o("edgeSharpness",parseFloat(e.toFixed(1))),min:.5,max:3,step:.1,color:"bg-purple-500",decimal:!0}),(0,a.jsx)(m,{label:"Surface Detail",value:l.surfaceDetail,onChange:e=>o("surfaceDetail",e),min:1,max:10,step:1,color:"bg-green-500"}),(0,a.jsx)(m,{label:"Noise Reduction",value:l.noiseReduction,onChange:e=>o("noiseReduction",e),min:0,max:10,step:1,color:"bg-orange-500"}),(0,a.jsx)(m,{label:"Contrast Boost",value:l.contrastBoost,onChange:e=>o("contrastBoost",parseFloat(e.toFixed(1))),min:.5,max:2.5,step:.1,color:"bg-pink-500",decimal:!0}),(0,a.jsx)(m,{label:"Depth Enhance",value:l.depthEnhancement,onChange:e=>o("depthEnhancement",parseFloat(e.toFixed(1))),min:.5,max:2.5,step:.1,color:"bg-indigo-500",decimal:!0})]}),(0,a.jsxs)("div",{className:"space-y-1.5 border-b border-white/20 pb-2",children:[(0,a.jsx)("h3",{className:"text-cyan-300 font-bold text-xs",children:"\uD83D\uDCCF Size"}),(0,a.jsx)(m,{label:"Depth",value:l.depth,onChange:e=>o("depth",e),min:10,max:200,step:5,color:"bg-white/40"}),(0,a.jsx)(m,{label:"Base Height",value:l.baseHeight,onChange:e=>o("baseHeight",e),min:0,max:30,step:1,color:"bg-white/40"})]}),(0,a.jsxs)("div",{className:"space-y-1 border-b border-white/20 pb-2",children:[(0,a.jsx)("h3",{className:"text-cyan-300 font-bold text-xs",children:"⚙️ Advanced"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-1",children:[(0,a.jsx)(g,{label:"HQ Normals",value:l.highQualityNormals,onChange:e=>o("highQualityNormals",e)}),(0,a.jsx)(g,{label:"Adaptive",value:l.adaptiveResolution,onChange:e=>o("adaptiveResolution",e)}),(0,a.jsx)(g,{label:"Invert",value:l.invertDepth,onChange:e=>o("invertDepth",e)})]})]}),(0,a.jsxs)("div",{className:"space-y-1 pb-2",children:[(0,a.jsx)("h3",{className:"text-cyan-300 font-bold text-xs",children:"\uD83D\uDC41️ Display"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-1",children:[(0,a.jsx)(g,{label:"Wire",value:l.wireframeMode,onChange:e=>o("wireframeMode",e)}),(0,a.jsx)(g,{label:"Rotate",value:l.autoRotate,onChange:e=>o("autoRotate",e)}),(0,a.jsx)(g,{label:"Grid",value:l.showGrid,onChange:e=>o("showGrid",e)})]}),(0,a.jsx)(m,{label:"Light",value:l.lightIntensity,onChange:e=>o("lightIntensity",parseFloat(e.toFixed(1))),min:.2,max:3,step:.1,color:"bg-yellow-500",decimal:!0})]})]})}function m(e){let{label:t,value:l,onChange:n,min:r,max:o,step:s,color:i,decimal:c=!1,tooltip:d}=e;return(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("label",{className:"text-white text-[10px] font-semibold",title:d,children:t}),(0,a.jsx)("span",{className:"text-white text-[10px] ".concat(i," px-1.5 py-0.5 rounded font-bold"),children:c?l.toFixed(1):l})]}),(0,a.jsx)("input",{type:"range",min:r,max:o,step:s,value:l,onChange:e=>n(parseFloat(e.target.value)),className:"w-full h-1.5 bg-white/20 rounded-lg appearance-none cursor-pointer",title:d||t})]})}function g(e){let{label:t,value:l,onChange:n}=e;return(0,a.jsx)("button",{onClick:()=>n(!l),className:"px-2 py-1 rounded text-[10px] font-bold transition-all ".concat(l?"bg-green-500 text-white":"bg-white/20 text-white/70"),children:t})}async function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{resolution:l=128,depth:a=90,smoothness:n=6,baseHeight:r=12,edgeSharpness:o=2,surfaceDetail:s=9,noiseReduction:i=5,contrastBoost:c=1.5,depthEnhancement:d=1.6,bilateralFilter:h=6,laplacianEnhancement:u=4,multiScaleProcessing:p=!0,edgePreservation:x=8,meshOptimization:m=!0,anisotropicDiffusion:g=5,unsharpMasking:f=4,gradientEnhancement:b=6,adaptiveContrast:v=!0,invertDepth:w=!1,projection:j="plane",adaptiveResolution:y=!0,highQualityNormals:N=!0,generateSolid:D=!0,onProgress:M}=t;return new Promise((t,C)=>{let E=new Image;E.onload=()=>{try{let e=document.createElement("canvas");e.width=l,e.height=l;let S=e.getContext("2d");if(!S){C(Error("Could not get canvas context"));return}S.drawImage(E,0,0,l,l);let F=S.getImageData(0,0,l,l);null==M||M(2);let k=[];for(let e=0;e<l;e++){k[e]=[];for(let t=0;t<l;t++){let a=(e*l+t)*4,n=F.data[a],r=F.data[a+1],i=F.data[a+2],d=(.2126*n+.7152*r+.0722*i)/255;if(v&&(d=function(e,t,l,a,n){let r=0,o=0;for(let n=-5;n<=5;n++)for(let s=-5;s<=5;s++){let i=l+n,c=t+s;if(i>=0&&i<a&&c>=0&&c<a){let t=(i*a+c)*4,l=e.data[t],n=e.data[t+1];r+=(.2126*l+.7152*n+.0722*e.data[t+2])/255,o++}}let s=r/o;return Math.min(1,Math.max(0,n+.3*(n-s)))}(F,t,e,l,d)),1!==c&&(d=Math.pow(d,1/c),d=Math.min(1,Math.max(0,d))),s>5){let e=Math.abs(n-r)+Math.abs(r-i)+Math.abs(i-n),t=(s-5)/5*.7;d+=e/765*t,d=Math.min(1,Math.max(0,d))}1!==o&&(d=Math.pow(d,1/o)),w&&(d=1-d),k[e][t]=d}}if(null==M||M(8),g>0&&(k=function(e,t,l){let a=e.map(e=>[...e]),n=Math.min(l,8);for(let e=0;e<n;e++){let e=[];for(let l=0;l<t;l++){e[l]=[];for(let n=0;n<t;n++){let r=a[l][n],o=0;for(let[e,s]of[[l-1,n],[l+1,n],[l,n-1],[l,n+1]])if(e>=0&&e<t&&s>=0&&s<t){let t=a[e][s]-r;o+=Math.exp(-(t*t)/(.1*.1))*t}e[l][n]=r+.2*o}}a=e}return a}(k,l,g)),null==M||M(15),p&&(k=function(e,t){let l=e.map(e=>[...e]),a=[1,2,4],n=[.5,.3,.2];for(let r=0;r<a.length;r++){let o=a[r],s=n[r];for(let a=0;a<t;a++)for(let n=0;n<t;n++){let r=0,i=0;for(let l=-o;l<=o;l++)for(let s=-o;s<=o;s++){let o=a+l,c=n+s;o>=0&&o<t&&c>=0&&c<t&&(r+=e[o][c],i++)}let c=r/i;l[a][n]=l[a][n]*(1-s)+c*s}}return l}(k,l)),null==M||M(22),h>0&&(k=function(e,t,l,a){let n=[],r=Math.min(l,8),o=.1*(11-a)/10,s=e.map(e=>[...e]);for(let e=0;e<r;e++){for(let e=0;e<t;e++){n[e]=[];for(let l=0;l<t;l++){let a=0,r=0,i=s[e][l];for(let n=-2;n<=2;n++)for(let c=-2;c<=2;c++){let d=e+n,h=l+c;if(d>=0&&d<t&&h>=0&&h<t){let e=Math.sqrt(c*c+n*n),t=Math.abs(s[d][h]-i),l=Math.exp(-(e*e)/8)*Math.exp(-(t*t)/(2*o*o));a+=s[d][h]*l,r+=l}}n[e][l]=a/r}}s=n.map(e=>[...e])}return n}(k,l,h,x)),null==M||M(30),i>0&&(k=function(e,t,l){let a=e.map(e=>[...e]),n=Math.min(l,6);for(let e=0;e<n;e++){let e=[];for(let l=0;l<t;l++){e[l]=[];for(let n=0;n<t;n++){let r=[];for(let e=-1;e<=1;e++)for(let o=-1;o<=1;o++){let s=l+e,i=n+o;s>=0&&s<t&&i>=0&&i<t&&r.push(a[s][i])}r.sort((e,t)=>e-t),e[l][n]=r[Math.floor(r.length/2)]}}a=e}return a}(k,l,i)),null==M||M(38),n>0&&(k=function(e,t,l){let a=e.map(e=>[...e]),n=Math.min(l,10);for(let e=0;e<n;e++){let e=[];for(let l=0;l<t;l++){e[l]=[];for(let n=0;n<t;n++){let r=0,o=0;for(let e=-3;e<=3;e++)for(let s=-3;s<=3;s++){let i=l+e,c=n+s;if(i>=0&&i<t&&c>=0&&c<t){let t=Math.sqrt(s*s+e*e),l=Math.exp(-(t*t)/5);r+=a[i][c]*l,o+=l}}e[l][n]=r/o}}a=e}return a}(k,l,n)),null==M||M(46),b>0&&(k=function(e,t,l){let a=[],n=l/10;for(let l=0;l<t;l++){a[l]=[];for(let r=0;r<t;r++){let o=0,s=0;r>0&&r<t-1&&(o=(e[l][r+1]-e[l][r-1])/2),l>0&&l<t-1&&(s=(e[l+1][r]-e[l-1][r])/2);let i=Math.sqrt(o*o+s*s)*n;a[l][r]=Math.min(1,Math.max(0,e[l][r]+i))}}return a}(k,l,b)),null==M||M(54),u>0&&(k=function(e,t,l){let a=[],n=l/10;for(let l=0;l<t;l++){a[l]=[];for(let r=0;r<t;r++){let o=0,s=e[l][r],i=0;for(let[a,n]of[[l-1,r],[l+1,r],[l,r-1],[l,r+1]])a>=0&&a<t&&n>=0&&n<t&&(o+=e[a][n]-s,i++);o/=i,a[l][r]=Math.min(1,Math.max(0,s+o*n))}}return a}(k,l,u)),null==M||M(60),f>0&&(k=function(e,t,l){let a=[],n=l/10;for(let l=0;l<t;l++){a[l]=[];for(let n=0;n<t;n++){let r=0,o=0;for(let a=-2;a<=2;a++)for(let s=-2;s<=2;s++){let i=l+a,c=n+s;if(i>=0&&i<t&&c>=0&&c<t){let t=Math.sqrt(s*s+a*a),l=Math.exp(-(t*t)/3);r+=e[i][c]*l,o+=l}}a[l][n]=r/o}}let r=[];for(let l=0;l<t;l++){r[l]=[];for(let o=0;o<t;o++){let t=e[l][o]-a[l][o];r[l][o]=Math.min(1,Math.max(0,e[l][o]+n*t))}}return r}(k,l,f)),null==M||M(66),1!==d)for(let e=0;e<l;e++)for(let t=0;t<l;t++)k[e][t]=Math.pow(k[e][t],d);for(let e=0;e<l;e++)for(let t=0;t<l;t++)k[e][t]=k[e][t]*a+r;null==M||M(72);let R=[],P=[];for(let e=0;e<l;e++)for(let t=0;t<l;t++){let a,n,r;let o=k[e][t];if("cylinder"===j){let s=t/l*Math.PI*2,i=l/4;a=Math.cos(s)*(i+o),n=e-l/2,r=Math.sin(s)*(i+o)}else if("cookie"===j){let s=t-l/2,i=e-l/2,c=Math.sqrt(s*s+i*i)/(l/2),d=35*Math.pow(c,2);a=s,n=o+d,r=i}else a=t-l/2,n=o,r=e-l/2;R.push(a,n,r)}for(let e=0;e<l-1;e++)for(let t=0;t<l-1;t++){let a=e*l+t,n=a+1,r=(e+1)*l+t,o=r+1;if(y){let l=k[e][t],s=k[e][t+1],i=k[e+1][t],c=k[e+1][t+1],d=Math.abs(l-c),h=Math.abs(s-i);d<h?(P.push(a,r,o),P.push(a,o,n)):(P.push(a,r,n),P.push(n,r,o))}else P.push(a,r,n),P.push(n,r,o)}if(null==M||M(77),D){let e=R.length/3;for(let e=0;e<l;e++)for(let t=0;t<l;t++){let a,n;if("cylinder"===j){let e=t/l*Math.PI*2,r=l/4;a=Math.cos(e)*r,n=Math.sin(e)*r}else if("cookie"===j){let r=t-l/2,o=e-l/2;a=r,n=o}else a=t-l/2,n=e-l/2;R.push(a,0,n)}null==M||M(80);for(let t=0;t<l-1;t++)for(let a=0;a<l-1;a++){let n=e+t*l+a,r=n+1,o=e+(t+1)*l+a,s=o+1;P.push(n,r,o),P.push(r,s,o)}null==M||M(84);for(let t=0;t<l-1;t++){let l=t,a=t+1,n=e+t,r=e+t+1;P.push(l,n,a),P.push(a,n,r)}for(let t=0;t<l-1;t++){let a=(l-1)*l+t,n=a+1,r=e+(l-1)*l+t,o=r+1;P.push(a,n,r),P.push(n,o,r)}for(let t=0;t<l-1;t++){let a=t*l,n=(t+1)*l,r=e+t*l,o=e+(t+1)*l;P.push(a,n,r),P.push(n,o,r)}for(let t=0;t<l-1;t++){let a=t*l+(l-1),n=(t+1)*l+(l-1),r=e+t*l+(l-1),o=e+(t+1)*l+(l-1);P.push(a,r,n),P.push(n,r,o)}}null==M||M(88);let A=new Float32Array(R),L=new Uint32Array(P);if(m){let e=function(e,t){let l=[];for(let a=0;a<t.length;a+=3){let n=3*t[a],r=3*t[a+1],o=3*t[a+2],s=e[n],i=e[n+1],c=e[n+2],d=e[r],h=e[r+1],u=e[r+2],p=e[o],x=e[o+1],m=e[o+2],g=d-s,f=h-i,b=u-c,v=p-s,w=x-i,j=m-c,y=f*j-b*w,N=b*v-g*j,D=g*w-f*v;Math.sqrt(y*y+N*N+D*D)>.001&&l.push(t[a],t[a+1],t[a+2])}return{vertices:e,indices:new Uint32Array(l)}}(A,L);A=e.vertices,L=e.indices}null==M||M(94);let U=N?function(e,t){let l=new Float32Array(e.length);for(let e=0;e<l.length;e++)l[e]=0;for(let a=0;a<t.length;a+=3){let n=3*t[a],r=3*t[a+1],o=3*t[a+2],s=e[n],i=e[n+1],c=e[n+2],d=e[r],h=e[r+1],u=e[r+2],p=e[o],x=e[o+1],m=e[o+2],g=d-s,f=h-i,b=u-c,v=p-s,w=x-i,j=m-c,y=f*j-b*w,N=b*v-g*j,D=g*w-f*v;l[n]+=y,l[n+1]+=N,l[n+2]+=D,l[r]+=y,l[r+1]+=N,l[r+2]+=D,l[o]+=y,l[o+1]+=N,l[o+2]+=D}for(let e=0;e<l.length;e+=3){let t=Math.sqrt(l[e]*l[e]+l[e+1]*l[e+1]+l[e+2]*l[e+2]);t>0&&(l[e]/=t,l[e+1]/=t,l[e+2]/=t)}return l}(A,L):function(e,t){let l=new Float32Array(e.length);for(let e=0;e<l.length;e++)l[e]=0;for(let a=0;a<t.length;a+=3){let n=3*t[a],r=3*t[a+1],o=3*t[a+2],s=e[n],i=e[n+1],c=e[n+2],d=e[r],h=e[r+1],u=e[r+2],p=e[o],x=e[o+1],m=e[o+2],g=d-s,f=h-i,b=u-c,v=p-s,w=x-i,j=m-c,y=f*j-b*w,N=b*v-g*j,D=g*w-f*v;l[n]+=y,l[n+1]+=N,l[n+2]+=D,l[r]+=y,l[r+1]+=N,l[r+2]+=D,l[o]+=y,l[o+1]+=N,l[o+2]+=D}for(let e=0;e<l.length;e+=3){let t=Math.sqrt(l[e]*l[e]+l[e+1]*l[e+1]+l[e+2]*l[e+2]);t>0&&(l[e]/=t,l[e+1]/=t,l[e+2]/=t)}return l}(A,L);null==M||M(100),t({vertices:A,indices:L,normals:U})}catch(e){C(e)}},E.onerror=()=>C(Error("Failed to load image")),E.src=e})}function b(e,t,l){let a=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],n=[l[0]-e[0],l[1]-e[1],l[2]-e[2]],r=[a[1]*n[2]-a[2]*n[1],a[2]*n[0]-a[0]*n[2],a[0]*n[1]-a[1]*n[0]],o=Math.sqrt(r[0]**2+r[1]**2+r[2]**2);return o>0&&(r[0]/=o,r[1]/=o,r[2]/=o),r}function v(){let[e,t]=(0,n.useState)(null),[l,o]=(0,n.useState)(""),[s,d]=(0,n.useState)(null),[h,u]=(0,n.useState)(!1),[m,g]=(0,n.useState)(0),[v,w]=(0,n.useState)({resolution:128,detailLevel:"med",depth:90,baseHeight:12,projection:"plane",smoothness:6,edgeSharpness:2,surfaceDetail:9,noiseReduction:5,contrastBoost:1.5,depthEnhancement:1.6,bilateralFilter:6,laplacianEnhancement:4,multiScaleProcessing:!0,edgePreservation:8,meshOptimization:!0,anisotropicDiffusion:5,unsharpMasking:4,gradientEnhancement:6,adaptiveContrast:!0,invertDepth:!1,adaptiveResolution:!0,highQualityNormals:!0,wireframeMode:!1,autoRotate:!1,lightIntensity:1.8,showGrid:!0}),j=(0,n.useRef)(null),y=(0,n.useCallback)(async e=>{var l;let a=null===(l=e.target.files)||void 0===l?void 0:l[0];if(!a)return;t(a);let n=new FileReader;n.onload=async e=>{var t;let l=null===(t=e.target)||void 0===t?void 0:t.result;o(l),await D(l,v)},n.readAsDataURL(a)},[v]),N=(0,n.useCallback)(e=>{w(e),l&&!h&&D(l,e)},[l,h]),D=async(e,t)=>{u(!0),g(0);try{let l=await f(e,{resolution:t.resolution,depth:t.depth,baseHeight:t.baseHeight,smoothness:t.smoothness,edgeSharpness:t.edgeSharpness,surfaceDetail:t.surfaceDetail,noiseReduction:t.noiseReduction,contrastBoost:t.contrastBoost,depthEnhancement:t.depthEnhancement,bilateralFilter:t.bilateralFilter,laplacianEnhancement:t.laplacianEnhancement,multiScaleProcessing:t.multiScaleProcessing,edgePreservation:t.edgePreservation,meshOptimization:t.meshOptimization,anisotropicDiffusion:t.anisotropicDiffusion,unsharpMasking:t.unsharpMasking,gradientEnhancement:t.gradientEnhancement,adaptiveContrast:t.adaptiveContrast,invertDepth:t.invertDepth,projection:t.projection,adaptiveResolution:t.adaptiveResolution,highQualityNormals:t.highQualityNormals,onProgress:e=>g(e)});d(l)}catch(e){console.error("Error generating mesh:",e),alert("Failed to generate 3D model. Try reducing Resolution to Med or Low.")}finally{u(!1)}},M=(0,n.useCallback)(()=>{if(s)try{console.log("Starting STL export..."),console.log("Mesh vertices:",s.vertices.length),console.log("Mesh indices:",s.indices.length),console.log("Triangles:",s.indices.length/3);let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{binary:l=!0}=t;return l?function(e){console.log("[STL Export] Starting binary export");let t=e.indices.length/3;console.log("[STL Export] Triangle count:",t);let l=84+50*t;console.log("[STL Export] Buffer size:",l,"bytes");let a=new ArrayBuffer(l),n=new DataView(a),r="Binary STL generated by File Conversion Studio";for(let e=0;e<80;e++)n.setUint8(e,e<r.length?r.charCodeAt(e):0);n.setUint32(80,t,!0),console.log("[STL Export] Header written");let o=84;for(let l=0;l<e.indices.length;l+=3){let a=3*e.indices[l],r=3*e.indices[l+1],s=3*e.indices[l+2],i=[e.vertices[a],e.vertices[a+1],e.vertices[a+2]],c=[e.vertices[r],e.vertices[r+1],e.vertices[r+2]],d=[e.vertices[s],e.vertices[s+1],e.vertices[s+2]],h=b(i,c,d);n.setFloat32(o,h[0],!0),o+=4,n.setFloat32(o,h[1],!0),o+=4,n.setFloat32(o,h[2],!0),o+=4,n.setFloat32(o,i[0],!0),o+=4,n.setFloat32(o,i[1],!0),o+=4,n.setFloat32(o,i[2],!0),o+=4,n.setFloat32(o,c[0],!0),o+=4,n.setFloat32(o,c[1],!0),o+=4,n.setFloat32(o,c[2],!0),o+=4,n.setFloat32(o,d[0],!0),o+=4,n.setFloat32(o,d[1],!0),o+=4,n.setFloat32(o,d[2],!0),o+=4,n.setUint16(o,0,!0),o+=2,l%3e3==0&&l>0&&console.log("[STL Export] Written ".concat(l/3,"/").concat(t," triangles"))}return console.log("[STL Export] All triangles written"),a}(e):function(e){let t="solid model\n";for(let l=0;l<e.indices.length;l+=3){let a=3*e.indices[l],n=3*e.indices[l+1],r=3*e.indices[l+2],o=[e.vertices[a],e.vertices[a+1],e.vertices[a+2]],s=[e.vertices[n],e.vertices[n+1],e.vertices[n+2]],i=[e.vertices[r],e.vertices[r+1],e.vertices[r+2]],c=b(o,s,i);t+="  facet normal ".concat(c[0]," ").concat(c[1]," ").concat(c[2],"\n")+"    outer loop\n"+"      vertex ".concat(o[0]," ").concat(o[1]," ").concat(o[2],"\n")+"      vertex ".concat(s[0]," ").concat(s[1]," ").concat(s[2],"\n")+"      vertex ".concat(i[0]," ").concat(i[1]," ").concat(i[2],"\n")+"    endloop\n  endfacet\n"}return t+="endsolid model\n"}(e)}(s,{binary:!0});e instanceof ArrayBuffer&&console.log("STL data generated, size:",e.byteLength);let t=new Blob([e],{type:"application/octet-stream"});console.log("Blob created");let l=URL.createObjectURL(t),a=document.createElement("a");a.href=l,a.download="model_".concat(Date.now(),".stl"),a.click(),URL.revokeObjectURL(l),console.log("Export complete!")}catch(e){console.error("Export failed:",e),alert("Export failed: "+e)}},[s]);return(0,a.jsxs)("div",{className:"min-h-screen gradient-section1 p-8",children:[(0,a.jsxs)("header",{className:"mb-8",children:[(0,a.jsx)(r.default,{href:"/",className:"text-white hover:underline mb-4 inline-block",children:"← Back to Home"}),(0,a.jsx)("h1",{className:"text-5xl font-bold text-white mb-2",children:"Image to 3D/4D Converter"}),(0,a.jsx)("p",{className:"text-white/80",children:"Transform your images into superior quality 3D models with professional tools"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6 h-[calc(100vh-200px)]",children:[(0,a.jsxs)("div",{className:"lg:col-span-1 card space-y-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Upload"}),(0,a.jsx)("div",{onClick:()=>{var e;return null===(e=j.current)||void 0===e?void 0:e.click()},className:"border-2 border-dashed border-white/30 rounded-lg p-6 text-center cursor-pointer hover:border-white/60 transition-all hover:bg-white/5",children:l?(0,a.jsx)("div",{className:"relative w-full h-32 mb-2",children:(0,a.jsx)(p.default,{src:l,alt:"Preview",fill:!0,className:"object-cover rounded-lg",unoptimized:!0})}):(0,a.jsxs)("div",{className:"text-white/60",children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCC1"}),(0,a.jsx)("p",{className:"text-sm",children:"Click to upload"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"JPG, PNG, BMP"})]})}),(0,a.jsx)("input",{ref:j,type:"file",accept:"image/jpeg,image/png,image/bmp",onChange:y,className:"hidden","aria-label":"Upload image file"}),h&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"w-full bg-white/20 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(m,"%")}})}),(0,a.jsxs)("p",{className:"text-white/80 text-sm text-center",children:["Processing: ",m,"%"]})]}),s&&(0,a.jsx)("button",{onClick:M,className:"btn-primary w-full bg-white text-purple-900 hover:bg-white/90 font-bold",children:"\uD83D\uDCBE Export STL"})]}),(0,a.jsxs)("div",{className:"lg:col-span-2 card relative",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"3D Preview"}),(0,a.jsx)("div",{className:"w-full h-[calc(100%-60px)] bg-black/20 rounded-lg overflow-hidden",children:s?(0,a.jsx)(i,{meshData:s,wireframe:v.wireframeMode,autoRotate:v.autoRotate,lightIntensity:v.lightIntensity}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-white/40",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDFA8"}),(0,a.jsx)("p",{className:"text-lg",children:"Upload an image to see the 3D preview"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Adjust settings for superior quality"})]})})})]}),(0,a.jsx)("div",{className:"lg:col-span-1 card overflow-y-auto max-h-[calc(100vh-200px)]",children:(0,a.jsx)(x,{onSettingsChange:N})}),(0,a.jsx)("div",{className:"lg:col-span-1 card overflow-y-auto max-h-[calc(100vh-200px)]",children:(0,a.jsx)(c,{meshData:s,onMeshUpdate:d})})]})]})}}},function(e){e.O(0,[689,648,961,971,117,744],function(){return e(e.s=4798)}),_N_E=e.O()}]);